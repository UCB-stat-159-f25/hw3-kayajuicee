<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA - HW3 – LIGO</title><meta property="og:title" content="BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA - HW3 – LIGO"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/build/4ca599c12ad03712a9fa6f4c109e48cc.svg"/><meta property="og:image" content="/build/4ca599c12ad03712a9fa6f4c109e48cc.svg"/><link rel="stylesheet" href="/build/_assets/app-PKKJHBHV.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R758p:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="HW3 – LIGO" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">HW3 – LIGO</a><a title="BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/losc-event-tutorial">BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA</a></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8u8p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78u8p:" data-state="closed">Ligo Scientific Collaboration (LSC) and Ji Su Youn</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="GHjIp7oKDz" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Ensure the repo root (one level up from notebooks/) is on sys.path
import sys, os
from pathlib import Path
REPO_ROOT = Path.cwd().parent
if str(REPO_ROOT) not in sys.path:
    sys.path.insert(0, str(REPO_ROOT))
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4Hc1oTn3vD1qMM9NBGGWt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tlhcSsRkac" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from pathlib import Path

# Folders relative to the repo root
DATADIR  = REPO_ROOT / &quot;data&quot;
FIGDIR   = REPO_ROOT / &quot;figures&quot;
AUDIODIR = REPO_ROOT / &quot;audio&quot;

FIGDIR.mkdir(exist_ok=True)
AUDIODIR.mkdir(exist_ok=True)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2qNlrLAP0c-6e4jf86j4Z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="cETRQRitVR" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from ligotools.utils import whiten, write_wavfile, reqshift, plot_psds
import json

fnjson = DATADIR / &quot;BBH_events_v3.json&quot;
events = json.load(open(fnjson, &quot;r&quot;))

eventname = &quot;GW150914&quot;           # or whichever event you need
event     = events[eventname]

fn_H1       = DATADIR / event[&quot;fn_H1&quot;]
fn_L1       = DATADIR / event[&quot;fn_L1&quot;]
fn_template = DATADIR / event[&quot;fn_template&quot;]
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mqIqld6PwrDydnQtdiyuu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="IREZpBO3md" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from pathlib import Path
FIGDIR = Path(&quot;figures&quot;); FIGDIR.mkdir(exist_ok=True)
AUDIODIR = Path(&quot;audio&quot;);  AUDIODIR.mkdir(exist_ok=True)
DATADIR = Path(&quot;data&quot;)     # already exists
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="K3jokfkh1QztZx-9yCbdF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="X6TQJOzNGJ" class="relative group/block"><p>This repository is public so that Binder can find it. All code and data is based on the original <a target="_blank" rel="noreferrer" href="https://github.com/losc-tutorial/LOSC_Event_tutorial" class="">LIGO Center for Open Science Tutorial Repository</a>. This repository is a class exercise that restructures the original LIGO code for improved reproducibility, as a homework assignment for the <a target="_blank" rel="noreferrer" href="https://ucb-stat-159-s23.github.io/" class="">Spring 2023 installment of UC Berkeley’s Stat 159/259 course, <em>Reproducible and Collaborative Data Science</em></a>. Authorship of the original analysis code rests with the LIGO collaboration.</p></div><div id="ixIyIKWYPw" class="relative group/block"><h1 id="binary-black-hole-signals-in-ligo-open-data" class="relative group"><span class="heading-text">BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#binary-black-hole-signals-in-ligo-open-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>Version 1.64, 2022 July 05</p><p>Welcome! This IPython notebook (or associated python script LOSC_Event_tutorial.py ) will go through some typical signal processing tasks on strain time-series data associated with the LIGO Event data releases from the LIGO Open Science Center (LOSC):</p><ul><li><p>Find events at <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/eventapi/" class="">https://<wbr/>www<wbr/>.gwosc<wbr/>.org<wbr/>/eventapi/</a>.</p></li><li><p>Run this tutorial with Binder using the link on the <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/tutorials/" class="">tutorials</a> page.</p></li><li><p>If you are running this tutorial on your own computer, see the <a target="_blank" rel="noreferrer" href="#Download-the-data" class="">Download</a> section below.</p></li><li><p>After setting the desired “eventname” below, you can just run the full notebook.</p></li></ul><p>Questions, comments, suggestions, corrections, etc: <a target="_blank" rel="noreferrer" href="https://ask.igwn.org" class="">ask.igwn.org</a></p></div><div id="OhIkh4Tqbo" class="relative group/block"><h2 id="this-tutorial-is-intended-for-educational-purposes-the-code-shown-here-is-not-used-to-produce-results-papers-published-by-the-ligo-scientific-collaboration-which-instead-rely-on-special-purpose-analysis-software-packages" class="relative group"><span class="heading-text">This tutorial is intended for educational purposes.  The code shown here is not used to produce results papers published by the LIGO Scientific Collaboration, which instead rely on special purpose analysis software packages.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#this-tutorial-is-intended-for-educational-purposes-the-code-shown-here-is-not-used-to-produce-results-papers-published-by-the-ligo-scientific-collaboration-which-instead-rely-on-special-purpose-analysis-software-packages" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="for-publicly-available-gravitational-wave-software-analysis-packages-that-are-used-to-produce-lsc-and-virgo-collaboration-results-papers-see-https-www-gwosc-org-software" class="relative group"><span class="heading-text">For publicly available, gravitational-wave software analysis packages that are used to produce LSC and Virgo Collaboration results papers, see <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/software/" class="">https://<wbr/>www<wbr/>.gwosc<wbr/>.org<wbr/>/software/</a>.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#for-publicly-available-gravitational-wave-software-analysis-packages-that-are-used-to-produce-lsc-and-virgo-collaboration-results-papers-see-https-www-gwosc-org-software" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><h3 id="for-technical-notes-on-this-tutorial-see-https-www-gwosc-org-bbh-tutorial-notes" class="relative group"><span class="heading-text">For technical notes on this tutorial, see <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/bbh_tutorial_notes/" class="">https://<wbr/>www<wbr/>.gwosc<wbr/>.org<wbr/>/bbh<wbr/>_tutorial<wbr/>_notes/</a>.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#for-technical-notes-on-this-tutorial-see-https-www-gwosc-org-bbh-tutorial-notes" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="EGSyMtPYpg" class="relative group/block"><h2 id="table-of-contents" class="relative group"><span class="heading-text">Table of Contents</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#table-of-contents" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li><p><span data-state="closed"><a href="#intro-to-signal-processing" class="hover-link">Intro to signal processing</a></span></p></li><li><p><span data-state="closed"><a href="#download-the-data-on-a-computer-with-a-python-installation" class="hover-link">Download the data</a></span></p></li><li><p><span data-state="closed"><a href="#set-the-event-name-to-choose-event-and-the-plot-type" class="hover-link">Set the event name to choose event and the plot type</a></span></p></li><li><p><span data-state="closed"><a href="#read-in-the-data" class="hover-link">Read in the data</a></span></p></li><li><p><a target="_blank" rel="noreferrer" href="#Plot-the-Amplitude-Spectral-Density-(ASD)" class="">Plot the ASD</a></p></li><li><p><a target="_blank" rel="noreferrer" href="#Binary-Neutron-Star-(BNS)-detection-range" class="">Binary Neutron Star detection range</a></p></li><li><p><span data-state="closed"><a href="#whitening" class="hover-link">Whitening</a></span></p></li><li><p><span data-state="closed"><a href="#spectrograms" class="hover-link">Spectrograms</a></span></p></li><li><p><span data-state="closed"><a href="#waveform-template" class="hover-link">Waveform Template</a></span></p></li><li><p><span data-state="closed"><a href="#matched-filtering-to-find-the-signal" class="hover-link">Matched filtering to find the signal</a></span></p></li><li><p><span data-state="closed"><a href="#make-sound-files" class="hover-link">Make sound Files</a></span></p></li><li><p><span data-state="closed"><a href="#data-segments" class="hover-link">Data segments</a></span></p></li></ul></div><div id="bOoHUAZkva" class="relative group/block"><h2 id="intro-to-signal-processing" class="relative group"><span class="heading-text">Intro to signal processing</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#intro-to-signal-processing" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This tutorial assumes that you are comfortable with <a target="_blank" rel="noreferrer" href="https://www.python.org/" class="">python</a>.</p><p>This tutorial also assumes that you know a bit about signal processing of digital time series data (or want to learn!). This includes power spectral densities, spectrograms, digital filtering, whitening, audio manipulation. This is a vast and complex set of topics, but we will cover many of the basics in this tutorial.</p><p>If you are a beginner, here are some resources from the web:</p><ul><li><p><a target="_blank" rel="noreferrer" href="http://101science.com/dsp.htm" class="">http://<wbr/>101science<wbr/>.com<wbr/>/dsp<wbr/>.htm</a></p></li><li><p><a target="_blank" rel="noreferrer" href="https://www.coursera.org/course/dsp" class="">https://<wbr/>www<wbr/>.coursera<wbr/>.org<wbr/>/course<wbr/>/dsp</a></p></li><li><p><a target="_blank" rel="noreferrer" href="https://georgemdallas.wordpress.com/2014/05/14/wavelets-4-dummies-signal-processing-fourier-transforms-and-heisenberg/" class="">https://<wbr/>georgemdallas<wbr/>.wordpress<wbr/>.com<wbr/>/2014<wbr/>/05<wbr/>/14<wbr/>/wavelets<wbr/>-4<wbr/>-dummies<wbr/>-signal<wbr/>-processing<wbr/>-fourier<wbr/>-transforms<wbr/>-and<wbr/>-heisenberg/</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Signal_processing" class="italic" target="_blank" rel="noreferrer" data-state="closed">Signal processing</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Spectral_density" class="italic" target="_blank" rel="noreferrer" data-state="closed">Spectral density</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Spectrogram" class="italic" target="_blank" rel="noreferrer" data-state="closed">Spectrogram</a></p></li><li><p><a target="_blank" rel="noreferrer" href="http://greenteapress.com/thinkdsp/" class="">http://<wbr/>greenteapress<wbr/>.com<wbr/>/thinkdsp/</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Digital_filter" class="italic" target="_blank" rel="noreferrer" data-state="closed">Digital filter</a></p></li></ul><p>And, well, lots more on the web!</p></div><div id="t7OjAvsOzv" class="relative group/block"><h2 id="download-the-data-on-a-computer-with-a-python-installation" class="relative group"><span class="heading-text">Download the data on a computer with a python installation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#download-the-data-on-a-computer-with-a-python-installation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>If you are using a pre-configured setup (eg, in binder), great! You don’t have to download or set up anything.</p><p>Otherwise, to begin, get the necessary files, by downloading the zip file and unpacking it into single directory:</p><ul><li><p><a target="_blank" rel="noreferrer" href="https://github.com/losc-tutorial/LOSC_Event_tutorial/archive/refs/heads/master.zip" class="">LOSC<wbr/>_Event<wbr/>_tutorial<wbr/>.zip</a></p></li></ul><p>This zip file contains:</p><ul><li><p>this IPython notebook LOSC_Event_tutorial.ipynb code.</p></li><li><p>python code for reading LOSC data files: readligo.py.</p></li><li><p>the event data files (32s sampled at 4096 Hz, in hdf5 format, for both LIGO detectors).</p></li><li><p>waveform templates (32s sampled at 4096 Hz, in hdf5 format, for both plus and cross polarizations).</p></li><li><p>a parameter file in json format</p></li></ul><p>You will also need a python installation with a few packages (<a target="_blank" rel="noreferrer" href="http://www.numpy.org/" class="">numpy</a>, <a target="_blank" rel="noreferrer" href="http://matplotlib.org/" class="">matplotlib</a>, <a target="_blank" rel="noreferrer" href="https://www.scipy.org/" class="">scipy</a>, <a target="_blank" rel="noreferrer" href="http://www.h5py.org/" class="">h5py</a>,  <a target="_blank" rel="noreferrer" href="https://docs.python.org/2/library/json.html" class="">json</a> ).</p><ul><li><p>For hints on software installation, see <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/tutorial00/" class="">https://<wbr/>www<wbr/>.gwosc<wbr/>.org<wbr/>/tutorial00/</a></p></li><li><p>The tutorial should work on python 2.6 and above, including python 3, as well as in recent versions of IPython.</p></li><li><p>You <em>might</em> see Warning or <code>FutureWarning</code> messages, which tend to be associated with different versions of python, Ipython, numpy, etc. Hopefully they can be ignored!</p></li><li><p>the filetype “hdf5” means the data are in hdf5 format:
<a target="_blank" rel="noreferrer" href="https://www.hdfgroup.org/HDF5/" class="">https://<wbr/>www<wbr/>.hdfgroup<wbr/>.org<wbr/>/HDF5/</a></p></li><li><p>NOTE: GPS time is number of seconds since Jan 6, 1980 GMT. See <a target="_blank" rel="noreferrer" href="http://www.oc.nps.edu/oc2902w/gps/timsys.html" class="">http://<wbr/>www<wbr/>.oc<wbr/>.nps<wbr/>.edu<wbr/>/oc2902w<wbr/>/gps<wbr/>/timsys<wbr/>.html</a> or <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/gps/" class="">https://<wbr/>www<wbr/>.gwosc<wbr/>.org<wbr/>/gps/</a></p></li></ul></div><div id="tOxUtZO9Pt" class="relative group/block"><h2 id="set-the-event-name-to-choose-event-and-the-plot-type" class="relative group"><span class="heading-text">Set the event name to choose event and the plot type</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#set-the-event-name-to-choose-event-and-the-plot-type" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="IP6nZRvrez" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#-- SET ME   Tutorial should work with most binary black hole events
#-- Default is no event selection; you MUST select one to proceed.
eventname = &#x27;&#x27;
eventname = &#x27;GW150914&#x27; 
#eventname = &#x27;GW151226&#x27; 
#eventname = &#x27;LVT151012&#x27;
#eventname = &#x27;GW170104&#x27;

# want plots?
make_plots = 1
plottype = &quot;png&quot;
#plottype = &quot;pdf&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NvAFQXwUgKo0FJnKL_8Bw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zlKhC5gwFC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Standard python numerical analysis imports:
import numpy as np
from scipy.signal import windows
from scipy.interpolate import interp1d
from scipy.signal import butter, filtfilt, iirdesign, zpk2tf, freqz
import h5py
import json

# the IPython magic below must be commented out in the .py file, since it doesn&#x27;t work there.
%matplotlib inline
%config InlineBackend.figure_format = &#x27;retina&#x27;
import matplotlib.pyplot as plt
import matplotlib.mlab as mlab

# LIGO-specific readligo.py 
from ligotools import readligo as rl

# Load LIGO strain data
strain_H1, time_H1, chan_H1 = rl.loaddata(fn_H1, &#x27;H1&#x27;)
strain_L1, time_L1, chan_L1 = rl.loaddata(fn_L1, &#x27;L1&#x27;)

# quick summary
print(&quot;H1:&quot;, len(strain_H1), &quot;points,&quot;, &quot;L1:&quot;, len(strain_L1), &quot;points&quot;)
# you might get a matplotlib warning here; you can ignore it.</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Y-_4YpuwDFoXoZfOT3l2a" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>H1: 131072 points, L1: 131072 points
</span></code></pre></div></div></div><div id="y9wFdKrocc" class="relative group/block"><h3 id="read-the-event-properties-from-a-local-json-file-download-in-advance" class="relative group"><span class="heading-text">Read the event properties from a local json file (download in advance):</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#read-the-event-properties-from-a-local-json-file-download-in-advance" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="QMCLXaipsE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Read the event properties from a local json file
fnjson = &quot;../data/BBH_events_v3.json&quot;
try:
    events = json.load(open(fnjson,&quot;r&quot;))
except IOError:
    print(&quot;Cannot find resource file &quot;+fnjson)
    print(&quot;You can download it from https://www.gwosc.org/s/events/&quot;+fnjson)
    print(&quot;Quitting.&quot;)
    quit()

# did the user select the eventname ?
eventname = &quot;GW150914&quot;

try: 
    events[eventname]
except:
    print(&#x27;You must select an eventname that is in &#x27;+fnjson+&#x27;! Quitting.&#x27;)
    quit()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ml3zUJgotm4B9s_XAk6GK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xn9PjOg6vt" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract the parameters for the desired event:
event = events[eventname]
fn_H1 = event[&#x27;fn_H1&#x27;]              # File name for H1 data
fn_L1 = event[&#x27;fn_L1&#x27;]              # File name for L1 data
fn_template = event[&#x27;fn_template&#x27;]  # File name for template waveform
fs = event[&#x27;fs&#x27;]                    # Set sampling rate
tevent = event[&#x27;tevent&#x27;]            # Set approximate event GPS time
fband = event[&#x27;fband&#x27;]              # frequency band for bandpassing signal
print(&quot;Reading in parameters for event &quot; + event[&quot;name&quot;])
print(event)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zBTeo1W8gFznpVbsAPdty" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Reading in parameters for event GW150914
{&#x27;name&#x27;: &#x27;GW150914&#x27;, &#x27;fn_H1&#x27;: &#x27;H-H1_LOSC_4_V2-1126259446-32.hdf5&#x27;, &#x27;fn_L1&#x27;: &#x27;L-L1_LOSC_4_V2-1126259446-32.hdf5&#x27;, &#x27;fn_template&#x27;: &#x27;GW150914_4_template.hdf5&#x27;, &#x27;fs&#x27;: 4096, &#x27;tevent&#x27;: 1126259462.44, &#x27;utcevent&#x27;: &#x27;2015-09-14T09:50:45.44&#x27;, &#x27;m1&#x27;: 41.743, &#x27;m2&#x27;: 29.237, &#x27;a1&#x27;: 0.355, &#x27;a2&#x27;: -0.769, &#x27;approx&#x27;: &#x27;lalsim.SEOBNRv2&#x27;, &#x27;fband&#x27;: [43.0, 300.0], &#x27;f_min&#x27;: 10.0}
</span></code></pre></div></div></div><div id="rNOaWt8HnB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
print(os.getcwd())
print(os.path.exists(fn_H1))
print(os.path.exists(fn_L1))
print(os.path.exists(fn_template))
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cT3qNKGoNtXwZv6HNVhY3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>/home/jovyan/hw3-kayajuicee/notebooks
False
False
False
</span></code></pre></div></div></div><div id="j9IxHudjci" class="relative group/block"><h2 id="read-in-the-data" class="relative group"><span class="heading-text">Read in the data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#read-in-the-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We will make use of the data, and waveform template, defined above.</p></div><div id="yXazsIfkUj" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from ligotools import readligo as rl

# File paths (pointing to your data folder)
fn_H1 = &quot;../data/&quot; + event[&quot;fn_H1&quot;]
fn_L1 = &quot;../data/&quot; + event[&quot;fn_L1&quot;]
fn_template = &quot;../data/&quot; + event[&quot;fn_template&quot;]

# Read in data from H1 and L1, if available
try:
    strain_H1, time_H1, chan_dict_H1 = rl.loaddata(fn_H1, &quot;H1&quot;)
    strain_L1, time_L1, chan_dict_L1 = rl.loaddata(fn_L1, &quot;L1&quot;)
except:
    print(&quot;Cannot find data files!&quot;)
    print(&quot;You can download them from https://www.gwosc.org/s/events/&quot; + eventname)
    print(&quot;Quitting.&quot;)
    quit()

# Print info to confirm successful load
print(&quot;time_H1:&quot;, len(time_H1), time_H1.min(), time_H1.max())
print(&quot;strain_H1:&quot;, len(strain_H1), strain_H1.min(), strain_H1.max())
print(&quot;strain_L1:&quot;, len(strain_L1), strain_L1.min(), strain_L1.max())
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="t5oA6OAFze6lk92U5qjby" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>time_H1: 131072 1126259446.0 1126259477.9997559
strain_H1: 131072 -7.044665943156067e-19 7.706262192397465e-19
strain_L1: 131072 -1.8697138664279764e-18 -4.60035111311666e-20
</span></code></pre></div></div></div><div id="RhysNTokIY" class="relative group/block"><h2 id="data-gaps" class="relative group"><span class="heading-text">Data Gaps</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-gaps" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>NOTE</strong> that in general, LIGO strain time series data has gaps (filled with NaNs) when the detectors are not taking valid (“science quality”) data. Analyzing these data requires the user to
<a target="_blank" rel="noreferrer" href="https://www.gwosc.org/timeline/" class="">loop over “segments”</a> of valid data stretches.</p><p><strong>In this tutorial, for simplicity, we assume there are no data gaps - this will not work for all times!</strong>  See the
<a target="_blank" rel="noreferrer" href="https://www.gwosc.org/timeline/" class="">notes on segments</a> for details.</p></div><div id="HmeKKP0IDz" class="relative group/block"><h2 id="first-look-at-the-data-from-h1-and-l1" class="relative group"><span class="heading-text">First look at the data from H1 and L1</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#first-look-at-the-data-from-h1-and-l1" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="kOPH18miai" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># both H1 and L1 will have the same time vector, so:
time = time_H1
# the time sample interval (uniformly sampled!)
dt = time[1] - time[0]

# Let&#x27;s look at the data and print out some stuff:

print(&#x27;time_H1: len, min, mean, max = &#x27;, \
    len(time_H1), time_H1.min(), time_H1.mean(), time_H1.max() )
print(&#x27;strain_H1: len, min, mean, max = &#x27;, \
    len(strain_H1), strain_H1.min(),strain_H1.mean(),strain_H1.max())
print( &#x27;strain_L1: len, min, mean, max = &#x27;, \
    len(strain_L1), strain_L1.min(),strain_L1.mean(),strain_L1.max())

#What&#x27;s in chan_dict?  (See also https://www.gwosc.org/tutorials/)
bits = chan_dict_H1[&#x27;DATA&#x27;]
print(&quot;For H1, {0} out of {1} seconds contain usable DATA&quot;.format(bits.sum(), len(bits)))
bits = chan_dict_L1[&#x27;DATA&#x27;]
print(&quot;For L1, {0} out of {1} seconds contain usable DATA&quot;.format(bits.sum(), len(bits)))
 </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="B6BppD-zLQO2BDwp_yNRx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>time_H1: len, min, mean, max =  131072 1126259446.0 1126259461.999878 1126259477.9997559
strain_H1: len, min, mean, max =  131072 -7.044665943156067e-19 5.895522509246437e-23 7.706262192397465e-19
strain_L1: len, min, mean, max =  131072 -1.8697138664279764e-18 -1.0522332249909908e-18 -4.60035111311666e-20
For H1, 32 out of 32 seconds contain usable DATA
For L1, 32 out of 32 seconds contain usable DATA
</span></code></pre></div></div></div><div id="ZBq1KBD87t" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># plot +- deltat seconds around the event:
# index into the strain time series for this time interval:
deltat = 5
indxt = np.where((time &gt;= tevent-deltat) &amp; (time &lt; tevent+deltat))
print(tevent)

if make_plots:
    plt.figure()
    plt.plot(time[indxt]-tevent,strain_H1[indxt],&#x27;r&#x27;,label=&#x27;H1 strain&#x27;)
    plt.plot(time[indxt]-tevent,strain_L1[indxt],&#x27;g&#x27;,label=&#x27;L1 strain&#x27;)
    plt.xlabel(&#x27;time (s) since &#x27;+str(tevent))
    plt.ylabel(&#x27;strain&#x27;)
    plt.legend(loc=&#x27;lower right&#x27;)
    plt.title(&#x27;Advanced LIGO strain data near &#x27;+eventname)
    plt.savefig(FIGDIR / f&quot;{eventname}_strain.{plottype}&quot;, dpi=150, bbox_inches=&quot;tight&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="stM3a2PZ-PZWz_HGoMkq7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>1126259462.44
</span></code></pre></div><img src="/build/0e81b6cabe76b3cbb710c480dca5d580.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><div id="LjJnGmFz9V" class="relative group/block"><p>The data are dominated by <strong>low frequency noise</strong>; there is no way to see a signal here, without some signal processing.</p></div><div id="Y9JkGCnb8r" class="relative group/block"><h2 id="plot-the-amplitude-spectral-density-asd" class="relative group"><span class="heading-text">Plot the Amplitude Spectral Density (ASD)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-the-amplitude-spectral-density-asd" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Plotting these data in the Fourier domain gives us an idea of the frequency content of the data. A way to visualize the frequency content of the data is to plot the amplitude spectral density, ASD.</p><p>The ASDs are the square root of the power spectral densities (PSDs), which are averages of the square of the fast fourier transforms (FFTs) of the data.</p><p>They are an estimate of the “strain-equivalent noise” of the detectors versus frequency,
which limit the ability of the detectors to identify GW signals.</p><p>They are in units of strain/rt(Hz).
So, if you want to know the root-mean-square (rms) strain noise in a frequency band,
integrate (sum) the squares of the ASD over that band, then take the square-root.</p><p>There’s a signal in these data!
For the moment, let’s ignore that, and assume it’s all noise.</p></div><div id="ULPIxnwMpT" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">make_psds = 1
if make_psds:
    # number of sample for the fast fourier transform:
    NFFT = 4*fs
    Pxx_H1, freqs = mlab.psd(strain_H1, Fs = fs, NFFT = NFFT)
    Pxx_L1, freqs = mlab.psd(strain_L1, Fs = fs, NFFT = NFFT)

    # We will use interpolations of the ASDs computed above for whitening:
    psd_H1 = interp1d(freqs, Pxx_H1)
    psd_L1 = interp1d(freqs, Pxx_L1)

    # Here is an approximate, smoothed PSD for H1 during O1, with no lines. We&#x27;ll use it later.    
    Pxx = (1.e-22*(18./(0.1+freqs))**2)**2+0.7e-23**2+((freqs/2000.)*4.e-23)**2
    psd_smooth = interp1d(freqs, Pxx)

if make_plots:
    # plot the ASDs, with the template overlaid:
    f_min = 20.
    f_max = 2000. 
    plt.figure(figsize=(10,8))
    plt.loglog(freqs, np.sqrt(Pxx_L1),&#x27;g&#x27;,label=&#x27;L1 strain&#x27;)
    plt.loglog(freqs, np.sqrt(Pxx_H1),&#x27;r&#x27;,label=&#x27;H1 strain&#x27;)
    plt.loglog(freqs, np.sqrt(Pxx),&#x27;k&#x27;,label=&#x27;H1 strain, O1 smooth model&#x27;)
    plt.axis([f_min, f_max, 1e-24, 1e-19])
    plt.grid(&#x27;on&#x27;)
    plt.ylabel(&#x27;ASD (strain/rtHz)&#x27;)
    plt.xlabel(&#x27;Freq (Hz)&#x27;)
    plt.legend(loc=&#x27;upper center&#x27;)
    plt.title(&#x27;Advanced LIGO strain data near &#x27;+eventname)
    plt.savefig(FIGDIR / f&quot;{eventname}_ASDs.{plottype}&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BaJgxXVjUqVmSY8uHLrY3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/ea11a0f0ad08a3f3aebd565ec297783e.png" alt="&lt;Figure size 1000x800 with 1 Axes&gt;"/></div></div><div id="cOyrqZINJ4" class="relative group/block"><p>NOTE that we only plot the data between f_min = 20 Hz and f_max = 2000 Hz.</p><p>Below f_min, the data <strong>are not properly calibrated</strong>. That’s OK, because the noise is so high below f_min that LIGO cannot sense gravitational wave strain from astrophysical sources in that band.</p><p>The sample rate is fs = 4096 Hz (2^12 Hz), so the data cannot capture frequency content above the Nyquist frequency = fs/2 = 2048 Hz. That’s OK, because our events only have detectable frequency content in the range given by fband, defined above; the upper end will (almost) always be below the Nyquist frequency. We set f_max = 2000, a bit below Nyquist.</p><p>You can see strong spectral lines in the data; they are all of instrumental origin. Some are engineered into the detectors (mirror suspension resonances at ~500 Hz and harmonics, calibration lines, control dither lines, etc) and some (60 Hz and harmonics) are unwanted. We’ll return to these, later.</p><p>You can’t see the signal in this plot, since it is relatively weak and less than a second long, while this plot averages over 32 seconds of data. So this plot is entirely dominated by instrumental noise.</p><p>The smooth model is hard-coded and tuned by eye; it won’t be right for arbitrary times. We will only use it below for things that don’t require much accuracy.</p></div><div id="OyHxNfgxoW" class="relative group/block"><h2 id="binary-neutron-star-bns-detection-range" class="relative group"><span class="heading-text">Binary Neutron Star (BNS) detection range</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#binary-neutron-star-bns-detection-range" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>A standard metric that LIGO uses to evaluate the sensitivity of our detectors, based on the detector noise ASD, is the BNS range.</p><p>This is defined as the distance to which a LIGO detector can register a BNS signal with a single detector signal-to-noise ratio (SNR) of 8, averaged over source direction and orientation.  Here, SNR 8 is used as a nominal detection threshold, similar to typical CBC detection thresholds of SNR 6-8.</p><p>We take each neutron star in the BNS system to have a mass of 1.4 times the mass of the sun, and negligible spin.</p><p>GWs from BNS mergers are like “standard sirens”; we know their amplitude at the source from theoretical calculations. The amplitude falls off like 1/r, so their amplitude at the detectors on Earth tells us how far away they are. This is great, because it is hard, in general, to know the distance to astronomical sources.</p><p>The amplitude at the source is computed in the post-Newtonian “quadrupole approximation”. This is valid for the inspiral phase only, and is approximate at best; there is no simple expression for the post-inspiral (merger and ringdown) phase. So this won’t work for high-mass binary black holes like GW150914, which have a lot of signal strength in the post-inspiral phase.</p><p>But, in order to use them as standard sirens, we need to know the source direction and orientation relative to the detector and its “quadrupole antenna pattern” response to such signals. It is a standard (if non-trivial) computation to average over all source directions and orientations; the average amplitude is 1./2.2648 times the maximum value.</p><p>This calculation is described in Appendix D of:
FINDCHIRP: An algorithm for detection of gravitational waves from inspiraling compact binaries
B. Allen et al., PHYSICAL REVIEW D 85, 122006 (2012) ; <a target="_blank" rel="noreferrer" href="http://arxiv.org/abs/gr-qc/0509116" class="">http://<wbr/>arxiv<wbr/>.org<wbr/>/abs<wbr/>/gr<wbr/>-qc<wbr/>/0509116</a></p></div><div id="R5HGiqPNSu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">BNS_range = 1
if BNS_range:
    #-- compute the binary neutron star (BNS) detectability range

    #-- choose a detector noise power spectrum:
    f = freqs.copy()
    # get frequency step size
    df = f[2]-f[1]

    #-- constants
    # speed of light:
    clight = 2.99792458e8                # m/s
    # Newton&#x27;s gravitational constant
    G = 6.67259e-11                      # m^3/kg/s^2 
    # one parsec, popular unit of astronomical distance (around 3.26 light years)
    parsec = 3.08568025e16               # m
    # solar mass
    MSol = 1.989e30                      # kg
    # solar mass in seconds (isn&#x27;t relativity fun?):
    tSol = MSol*G/np.power(clight,3)     # s
    # Single-detector SNR for detection above noise background: 
    SNRdet = 8.
    # conversion from maximum range (horizon) to average range:
    Favg = 2.2648
    # mass of a typical neutron star, in solar masses:
    mNS = 1.4

    # Masses in solar masses
    m1 = m2 = mNS    
    mtot = m1+m2  # the total mass
    eta = (m1*m2)/mtot**2  # the symmetric mass ratio
    mchirp = mtot*eta**(3./5.)  # the chirp mass (FINDCHIRP, following Eqn 3.1b)

    # distance to a fiducial BNS source:
    dist = 1.0                           # in Mpc
    Dist =  dist * 1.0e6 * parsec /clight # from Mpc to seconds

    # We integrate the signal up to the frequency of the &quot;Innermost stable circular orbit (ISCO)&quot; 
    R_isco = 6.      # Orbital separation at ISCO, in geometric units. 6M for PN ISCO; 2.8M for EOB 
    # frequency at ISCO (end the chirp here; the merger and ringdown follow) 
    f_isco = 1./(np.power(R_isco,1.5)*np.pi*tSol*mtot)
    # minimum frequency (below which, detector noise is too high to register any signal):
    f_min = 20. # Hz
    # select the range of frequencies between f_min and fisco
    fr = np.nonzero(np.logical_and(f &gt; f_min , f &lt; f_isco))
    # get the frequency and spectrum in that range:
    ffr = f[fr]

    # In stationary phase approx, this is htilde(f):  
    # See FINDCHIRP Eqns 3.4, or 8.4-8.5 
    htilde = (2.*tSol/Dist)*np.power(mchirp,5./6.)*np.sqrt(5./96./np.pi)*(np.pi*tSol)
    htilde *= np.power(np.pi*tSol*ffr,-7./6.)
    htilda2 = htilde**2

    # loop over the detectors
    dets = [&#x27;H1&#x27;, &#x27;L1&#x27;]
    for det in dets:
        if det == &#x27;L1&#x27;: sspec = Pxx_L1.copy()
        else:           sspec = Pxx_H1.copy()
        sspecfr = sspec[fr]
        # compute &quot;inspiral horizon distance&quot; for optimally oriented binary; FINDCHIRP Eqn D2:
        D_BNS = np.sqrt(4.*np.sum(htilda2/sspecfr)*df)/SNRdet
        # and the &quot;inspiral range&quot;, averaged over source direction and orientation:
        R_BNS = D_BNS/Favg
        print(det+&#x27; BNS inspiral horizon = {0:.1f} Mpc, BNS inspiral range   = {1:.1f} Mpc&#x27;.format(D_BNS,R_BNS))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AbdZ1jHp1cfbatF5EUqVQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>H1 BNS inspiral horizon = 169.4 Mpc, BNS inspiral range   = 74.8 Mpc
L1 BNS inspiral horizon = 147.1 Mpc, BNS inspiral range   = 64.9 Mpc
</span></code></pre></div></div></div><div id="ehc5Rb90yN" class="relative group/block"><h2 id="bbh-range-is-bns-range" class="relative group"><span class="heading-text">BBH range is &gt;&gt; BNS range!</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#bbh-range-is-bns-range" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>NOTE that, since mass is the source of gravity and thus also of gravitational waves, systems with higher masses (such as the binary black hole merger GW150914) are much “louder” and can be detected to much higher distances than the BNS range. We’ll compute the BBH range, using a template with specific masses, below.</p></div><div id="WSK6uUxROF" class="relative group/block"><h2 id="whitening" class="relative group"><span class="heading-text">Whitening</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#whitening" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>From the ASD above, we can see that the data are very strongly “colored” - noise fluctuations are much larger at low and high frequencies and near spectral lines, reaching a roughly flat (“white”) minimum in the band around 80 to 300 Hz.</p><p>We can “whiten” the data (dividing it by the noise amplitude spectrum, in the fourier domain), suppressing the extra noise at low frequencies and at the spectral lines, to better see the weak signals in the most sensitive band.</p><p>Whitening is always one of the first steps in astrophysical data analysis (searches, parameter estimation).
Whitening requires no prior knowledge of spectral lines, etc; only the data are needed.</p><p>To get rid of remaining high frequency noise, we will also bandpass the data.</p><p>The resulting time series is no longer in units of strain; now in units of “sigmas” away from the mean.</p><p>We will plot the whitened strain data, along with the signal template, after the matched filtering section, below.</p></div><div id="UHYhHLj4d6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># function to whiten data
def whiten(strain, interp_psd, dt):
    Nt = len(strain)
    freqs = np.fft.rfftfreq(Nt, dt)
    freqs1 = np.linspace(0, 2048, Nt // 2 + 1)

    # whitening: transform to freq domain, divide by asd, then transform back, 
    # taking care to get normalization right.
    hf = np.fft.rfft(strain)
    norm = 1./np.sqrt(1./(dt*2))
    white_hf = hf / np.sqrt(interp_psd(freqs)) * norm
    white_ht = np.fft.irfft(white_hf, n=Nt)
    return white_ht

whiten_data = 1
if whiten_data:
    # now whiten the data from H1 and L1, and the template (use H1 PSD):
    strain_H1_whiten = whiten(strain_H1,psd_H1,dt)
    strain_L1_whiten = whiten(strain_L1,psd_L1,dt)
    
    # We need to suppress the high frequency noise (no signal!) with some bandpassing:
    bb, ab = butter(4, [fband[0]*2./fs, fband[1]*2./fs], btype=&#x27;band&#x27;)
    normalization = np.sqrt((fband[1]-fband[0])/(fs/2))
    strain_H1_whitenbp = filtfilt(bb, ab, strain_H1_whiten) / normalization
    strain_L1_whitenbp = filtfilt(bb, ab, strain_L1_whiten) / normalization</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CnKQ20hMhSs4buPHbMpUo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wZo5EqNNRd" class="relative group/block"><h2 id="spectrograms" class="relative group"><span class="heading-text">Spectrograms</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#spectrograms" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now let’s plot a short time-frequency spectrogram around our event:</p></div><div id="fhgVhQnnC9" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">if make_plots:
    # index into the strain time series for this time interval:
    indxt = np.where((time &gt;= tevent-deltat) &amp; (time &lt; tevent+deltat))

    # pick a shorter FTT time interval, like 1/8 of a second:
    NFFT = int(fs/8)
    # and with a lot of overlap, to resolve short-time features:
    NOVL = int(NFFT*15./16)
    # and choose a window that minimizes &quot;spectral leakage&quot; 
    # (https://en.wikipedia.org/wiki/Spectral_leakage)
    window = np.blackman(NFFT)

    # the right colormap is all-important! See:
    # http://matplotlib.org/examples/color/colormaps_reference.html
    # viridis seems to be the best for our purposes, but it&#x27;s new; if you don&#x27;t have it, you can settle for ocean.
    #spec_cmap=&#x27;viridis&#x27;
    spec_cmap=&#x27;ocean&#x27;

    # Plot the H1 spectrogram:
    plt.figure(figsize=(10,6))
    spec_H1, freqs, bins, im = plt.specgram(strain_H1[indxt], NFFT=NFFT, Fs=fs, window=window, 
                                            noverlap=NOVL, cmap=spec_cmap, xextent=[-deltat,deltat])
    plt.xlabel(&#x27;time (s) since &#x27;+str(tevent))
    plt.ylabel(&#x27;Frequency (Hz)&#x27;)
    plt.colorbar()
    plt.axis([-deltat, deltat, 0, 2000])
    plt.title(&#x27;aLIGO H1 strain data near &#x27;+eventname)
    plt.savefig(FIGDIR / f&quot;{eventname}_H1_spectrogram.{plottype}&quot;)

    # Plot the L1 spectrogram:
    plt.figure(figsize=(10,6))
    spec_H1, freqs, bins, im = plt.specgram(strain_L1[indxt], NFFT=NFFT, Fs=fs, window=window, 
                                            noverlap=NOVL, cmap=spec_cmap, xextent=[-deltat,deltat])
    plt.xlabel(&#x27;time (s) since &#x27;+str(tevent))
    plt.ylabel(&#x27;Frequency (Hz)&#x27;)
    plt.colorbar()
    plt.axis([-deltat, deltat, 0, 2000])
    plt.title(&#x27;aLIGO L1 strain data near &#x27;+eventname)
    plt.savefig(FIGDIR / f&quot;{eventname}_L1_spectrogram.{plottype}&quot;)

</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ga7AwExpz-O633lVS2p4P" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/f1b78858bd0b967c8a55fedc99c90cf2.png" alt="&lt;Figure size 1000x600 with 2 Axes&gt;"/><img src="/build/e535a0c0c91b9e670e597b10b8e2c0c2.png" alt="&lt;Figure size 1000x600 with 2 Axes&gt;"/></div></div><div id="Zi5ZNptJ4M" class="relative group/block"><p>In the above spectrograms, you may see lots of excess power below ~20 Hz, as well as strong spectral lines at 500, 1000, 1500 Hz (also evident in the ASDs above). The lines at multiples of 500 Hz are the harmonics of the “violin modes” of the fibers holding up the mirrors of the Advanced LIGO interferometers.</p><p>Now let’s zoom in on where we think the signal is, using the whitened data, in the hope of seeing a chirp:</p></div><div id="Ruh4LVjgv6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">if make_plots:
    #  plot the whitened data, zooming in on the signal region:

    # pick a shorter FTT time interval, like 1/16 of a second:
    NFFT = int(fs/16.0)
    # and with a lot of overlap, to resolve short-time features:
    NOVL = int(NFFT*15/16.0)
    # choose a window that minimizes &quot;spectral leakage&quot; 
    # (https://en.wikipedia.org/wiki/Spectral_leakage)
    window = np.blackman(NFFT)

    # Plot the H1 whitened spectrogram around the signal
    plt.figure(figsize=(10,6))
    spec_H1, freqs, bins, im = plt.specgram(strain_H1_whiten[indxt], NFFT=NFFT, Fs=fs, window=window, 
                                            noverlap=NOVL, cmap=spec_cmap, xextent=[-deltat,deltat])
    plt.xlabel(&#x27;time (s) since &#x27;+str(tevent))
    plt.ylabel(&#x27;Frequency (Hz)&#x27;)
    plt.colorbar()
    plt.axis([-0.5, 0.5, 0, 500])
    plt.title(&#x27;aLIGO H1 strain data near &#x27;+eventname)
    plt.savefig(FIGDIR / f&quot;{eventname}_H1_spectrogram_whitened.{plottype}&quot;)

    # Plot the L1 whitened spectrogram around the signal
    plt.figure(figsize=(10,6))
    spec_H1, freqs, bins, im = plt.specgram(strain_L1_whiten[indxt], NFFT=NFFT, Fs=fs, window=window, 
                                            noverlap=NOVL, cmap=spec_cmap, xextent=[-deltat,deltat])
    plt.xlabel(&#x27;time (s) since &#x27;+str(tevent))
    plt.ylabel(&#x27;Frequency (Hz)&#x27;)
    plt.colorbar()
    plt.axis([-0.5, 0.5, 0, 500])
    plt.title(&#x27;aLIGO L1 strain data near &#x27;+eventname)
    plt.savefig(FIGDIR / f&quot;{eventname}_L1_spectrogram_whitened.{plottype}&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qYL6Bwr2COO3W2h9_sYD-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/build/cf74e252479e6610703430205c6de9d2.png" alt="&lt;Figure size 1000x600 with 2 Axes&gt;"/><img src="/build/6a563d45be0a37bf1a84cf7c5b6c0284.png" alt="&lt;Figure size 1000x600 with 2 Axes&gt;"/></div></div><div id="Z36KvjTai3" class="relative group/block"><p>Loud (high SNR) signals may be visible in these spectrograms.  Compact object mergers show a characteristic “chirp” as the signal rises in frequency.  If you can’t see anything, try
<a target="_blank" rel="noreferrer" href="https://www.gwosc.org/events/GW150914/" class="">event GW150914</a>, by changing the <code>eventname</code> variable in the first cell above.</p></div><div id="EojjxplFgP" class="relative group/block"><h2 id="waveform-template" class="relative group"><span class="heading-text">Waveform Template</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#waveform-template" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The results of a full LIGO-Virgo analysis of this BBH event include a set of parameters that are consistent with a range of parameterized waveform templates. Here we pick one for use in matched filtering.</p><p>As noted above, the results won’t be identical to what is in the LIGO-Virgo papers, since we’re skipping many subtleties, such as combining many consistent templates.</p></div><div id="RoPrYa1bmA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># read in the template (plus and cross) and parameters for the theoretical waveform
try:
    f_template = h5py.File(fn_template, &quot;r&quot;)
except:
    print(&quot;Cannot find template file!&quot;)
    print(&quot;You can download it from https://www.gwosc.org/s/events/&quot;+eventname+&#x27;/&#x27;+fn_template)
    print(&quot;Quitting.&quot;)
    quit()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vB3_ZesuEwCDajW1ogBDx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="lAbBvOFbGN" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># extract metadata from the template file:
template_p, template_c = f_template[&quot;template&quot;][...]
t_m1 = f_template[&quot;/meta&quot;].attrs[&#x27;m1&#x27;]
t_m2 = f_template[&quot;/meta&quot;].attrs[&#x27;m2&#x27;]
t_a1 = f_template[&quot;/meta&quot;].attrs[&#x27;a1&#x27;]
t_a2 = f_template[&quot;/meta&quot;].attrs[&#x27;a2&#x27;]
t_approx = f_template[&quot;/meta&quot;].attrs[&#x27;approx&#x27;]
f_template.close()
# the template extends to roughly 16s, zero-padded to the 32s data length. The merger will be roughly 16s in.
template_offset = 16.

# whiten the templates:
template_p_whiten = whiten(template_p,psd_H1,dt)
template_c_whiten = whiten(template_c,psd_H1,dt)
template_p_whitenbp = filtfilt(bb, ab, template_p_whiten) / normalization
template_c_whitenbp = filtfilt(bb, ab, template_c_whiten) / normalization

# Compute, print and plot some properties of the template:

# constants:
clight = 2.99792458e8                # m/s
G = 6.67259e-11                      # m^3/kg/s^2 
MSol = 1.989e30                      # kg

# template parameters: masses in units of MSol:
t_mtot = t_m1+t_m2
# final BH mass is typically 95% of the total initial mass:
t_mfin = t_mtot*0.95
# Final BH radius, in km:
R_fin = 2*G*t_mfin*MSol/clight**2/1000.

# complex template:
template = (template_p + template_c*1.j) 
ttime = time-time[0]-template_offset

# compute the instantaneous frequency of this chirp-like signal:
tphase = np.unwrap(np.angle(template))
fGW = np.gradient(tphase)*fs/(2.*np.pi)
# fix discontinuities at the very end:
# iffix = np.where(np.abs(np.gradient(fGW)) &gt; 100.)[0]
iffix = np.where(np.abs(template) &lt; np.abs(template).max()*0.001)[0]
fGW[iffix] = fGW[iffix[0]-1]
fGW[np.where(fGW &lt; 1.)] = fGW[iffix[0]-1]

# compute v/c:
voverc = (G*t_mtot*MSol*np.pi*fGW/clight**3)**(1./3.)

# index where f_GW is in-band:
f_inband = fband[0]
iband = np.where(fGW &gt; f_inband)[0][0]
# index at the peak of the waveform:
ipeak = np.argmax(np.abs(template))

# number of cycles between inband and peak:
Ncycles = (tphase[ipeak]-tphase[iband])/(2.*np.pi)

print(&#x27;Properties of waveform template in {0}&#x27;.format(fn_template))
print(&quot;Waveform family = {0}&quot;.format(t_approx))
print(&quot;Masses = {0:.2f}, {1:.2f} Msun&quot;.format(t_m1,t_m2))
print(&#x27;Mtot = {0:.2f} Msun, mfinal = {1:.2f} Msun &#x27;.format(t_mtot,t_mfin))
print(&quot;Spins = {0:.2f}, {1:.2f}&quot;.format(t_a1,t_a2))
print(&#x27;Freq at inband, peak = {0:.2f}, {1:.2f} Hz&#x27;.format(fGW[iband],fGW[ipeak]))
print(&#x27;Time at inband, peak = {0:.2f}, {1:.2f} s&#x27;.format(ttime[iband],ttime[ipeak]))
print(&#x27;Duration (s) inband-peak = {0:.2f} s&#x27;.format(ttime[ipeak]-ttime[iband]))
print(&#x27;N_cycles inband-peak = {0:.0f}&#x27;.format(Ncycles))
print(&#x27;v/c at peak = {0:.2f}&#x27;.format(voverc[ipeak]))
print(&#x27;Radius of final BH = {0:.0f} km&#x27;.format(R_fin))

if make_plots:
    plt.figure(figsize=(10,16))
    plt.subplot(4,1,1)
    plt.plot(ttime,template_p)
    plt.xlim([-template_offset,1.])
    plt.grid()
    plt.xlabel(&#x27;time (s)&#x27;)
    plt.ylabel(&#x27;strain&#x27;)
    plt.title(eventname+&#x27; template at D_eff = 1 Mpc&#x27;)
    
    plt.subplot(4,1,2)
    plt.plot(ttime,template_p)
    plt.xlim([-1.1,0.1])
    plt.grid()
    plt.xlabel(&#x27;time (s)&#x27;)
    plt.ylabel(&#x27;strain&#x27;)
    #plt.title(eventname+&#x27; template at D_eff = 1 Mpc&#x27;)
    
    plt.subplot(4,1,3)
    plt.plot(ttime,fGW)
    plt.xlim([-1.1,0.1])
    plt.grid()
    plt.xlabel(&#x27;time (s)&#x27;)
    plt.ylabel(&#x27;f_GW&#x27;)
    #plt.title(eventname+&#x27; template f_GW&#x27;)
    
    plt.subplot(4,1,4)
    plt.plot(ttime,voverc)
    plt.xlim([-1.1,0.1])
    plt.grid()
    plt.xlabel(&#x27;time (s)&#x27;)
    plt.ylabel(&#x27;v/c&#x27;)
    #plt.title(eventname+&#x27; template v/c&#x27;)
    plt.savefig(FIGDIR / f&quot;{eventname}_template.{plottype}&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="IuxfeY96Y6FUFv7JeRbSE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Properties of waveform template in ../data/GW150914_4_template.hdf5
Waveform family = lalsim.SEOBNRv2
Masses = 41.74, 29.24 Msun
Mtot = 70.98 Msun, mfinal = 67.43 Msun 
Spins = 0.35, -0.77
Freq at inband, peak = 43.05, 169.84 Hz
Time at inband, peak = -0.08, -0.02 s
Duration (s) inband-peak = 0.06 s
N_cycles inband-peak = 4
v/c at peak = 0.57
Radius of final BH = 199 km
</span></code></pre></div><img src="/build/dfe015ee1f617827cd17e7ac387f6ef0.png" alt="&lt;Figure size 1000x1600 with 4 Axes&gt;"/></div></div><div id="ImAQ2P3N3w" class="relative group/block"><h2 id="matched-filtering-to-find-the-signal" class="relative group"><span class="heading-text">Matched filtering to find the signal</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#matched-filtering-to-find-the-signal" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Matched filtering is the optimal way to find a known signal buried in stationary, Gaussian noise. It is the standard technique used by the gravitational wave community to find GW signals from compact binary mergers in noisy detector data.</p><p>For some loud signals, it may be possible to see the signal in the whitened data or spectrograms. On the other hand, low signal-to-noise ratio (SNR) signals or signals which are of long duration in time may not be visible, even in the whitened data.  LIGO scientists use matched filtering to find such “hidden” signals. A matched filter works by compressing the entire signal into one time bin (by convention, the “end time” of the waveform).</p><p>LIGO uses a rather elaborate software suite to match the data against a family of such signal waveforms (“templates”), to find the best match. This procedure helps to “optimally” separate signals from instrumental noise, and to infer the parameters of the source (masses, spins, sky location, orbit orientation, etc) from the best match templates.</p><p>A blind search requires us to search over many compact binary merger templates (eg, 250,000) with different masses and spins, as well as over all times in all detectors, and then requiring triggers coincident in time and template between detectors. It’s an extremely complex and computationally-intensive “search pipeline”.</p><p>Here, we simplify things, using only one template (the one identified in the full search as being a good match to the data).</p><p>Assuming that the data around this event is fairly Gaussian and stationary, we’ll use this simple method to identify the signal (matching the template) in our 32 second stretch of data. The peak in the SNR vs time is a “single-detector event trigger”.</p><p>This calculation is described in section IV of:
FINDCHIRP: An algorithm for detection of gravitational waves from inspiraling compact binaries
B. Allen et al., PHYSICAL REVIEW D 85, 122006 (2012) ; <a target="_blank" rel="noreferrer" href="http://arxiv.org/abs/gr-qc/0509116" class="">http://<wbr/>arxiv<wbr/>.org<wbr/>/abs<wbr/>/gr<wbr/>-qc<wbr/>/0509116</a></p><p>The full search procedure is described in
GW150914: First results from the search for binary black hole coalescence with Advanced LIGO,
The LIGO Scientific Collaboration, the Virgo Collaboration, <a target="_blank" rel="noreferrer" href="http://arxiv.org/abs/1602.03839" class="">http://<wbr/>arxiv<wbr/>.org<wbr/>/abs<wbr/>/1602<wbr/>.03839</a></p></div><div id="VTsZLtTDw4" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># -- To calculate the PSD of the data, choose an overlap and a window (common to all detectors)
#   that minimizes &quot;spectral leakage&quot; https://en.wikipedia.org/wiki/Spectral_leakage
NFFT = 4*fs
psd_window = np.blackman(NFFT)
# and a 50% overlap:
NOVL = NFFT//2

# define the complex template, common to both detectors:
template = (template_p + template_c*1.j) 
# We will record the time where the data match the END of the template.
etime = time+template_offset
# the length and sampling rate of the template MUST match that of the data.
datafreq = np.fft.fftfreq(template.size)*fs
df = np.abs(datafreq[1] - datafreq[0])

# to remove effects at the beginning and end of the data stretch, window the data
# https://en.wikipedia.org/wiki/Window_function#Tukey_window
try:   dwindow = windows.tukey(template.size, alpha=1./8)  # Tukey window preferred, but requires recent scipy version 
except: dwindow = windows.blackman(template.size)          # Blackman window OK if Tukey is not available

# prepare the template fft.
template_fft = np.fft.fft(template*dwindow) / fs

# loop over the detectors
dets = [&#x27;H1&#x27;, &#x27;L1&#x27;]
for det in dets:

    if det == &#x27;L1&#x27;: data = strain_L1.copy()
    else:           data = strain_H1.copy()

    # -- Calculate the PSD of the data.  Also use an overlap, and window:
    data_psd, freqs = mlab.psd(data, Fs = fs, NFFT = NFFT, window=psd_window, noverlap=NOVL)

    # Take the Fourier Transform (FFT) of the data and the template (with dwindow)
    data_fft = np.fft.fft(data*dwindow) / fs

    # -- Interpolate to get the PSD values at the needed frequencies
    power_vec = np.interp(np.abs(datafreq), freqs, data_psd)

    # -- Calculate the matched filter output in the time domain:
    # Multiply the Fourier Space template and data, and divide by the noise power in each frequency bin.
    # Taking the Inverse Fourier Transform (IFFT) of the filter output puts it back in the time domain,
    # so the result will be plotted as a function of time off-set between the template and the data:
    optimal = data_fft * template_fft.conjugate() / power_vec
    optimal_time = 2*np.fft.ifft(optimal)*fs

    # -- Normalize the matched filter output:
    # Normalize the matched filter output so that we expect a value of 1 at times of just noise.
    # Then, the peak of the matched filter output will tell us the signal-to-noise ratio (SNR) of the signal.
    sigmasq = 1*(template_fft * template_fft.conjugate() / power_vec).sum() * df
    sigma = np.sqrt(np.abs(sigmasq))
    SNR_complex = optimal_time/sigma

    # shift the SNR vector by the template length so that the peak is at the END of the template
    peaksample = int(data.size / 2)  # location of peak in the template
    SNR_complex = np.roll(SNR_complex,peaksample)
    SNR = abs(SNR_complex)

    # find the time and SNR value at maximum:
    indmax = np.argmax(SNR)
    timemax = time[indmax]
    SNRmax = SNR[indmax]

    # Calculate the &quot;effective distance&quot; (see FINDCHIRP paper for definition)
    # d_eff = (8. / SNRmax)*D_thresh
    d_eff = sigma / SNRmax
    # -- Calculate optimal horizon distnace
    horizon = sigma/8

    # Extract time offset and phase at peak
    phase = np.angle(SNR_complex[indmax])
    offset = (indmax-peaksample)

    # apply time offset, phase, and d_eff to template 
    template_phaseshifted = np.real(template*np.exp(1j*phase))    # phase shift the template
    template_rolled = np.roll(template_phaseshifted,offset) / d_eff  # Apply time offset and scale amplitude
    
    # Whiten and band-pass the template for plotting
    template_whitened = whiten(template_rolled,interp1d(freqs, data_psd),dt)  # whiten the template
    template_match = filtfilt(bb, ab, template_whitened) / normalization # Band-pass the template
    
    print(&#x27;For detector {0}, maximum at {1:.4f} with SNR = {2:.1f}, D_eff = {3:.2f}, horizon = {4:0.1f} Mpc&#x27; 
          .format(det,timemax,SNRmax,d_eff,horizon))

    if make_plots:

        # plotting changes for the detectors:
        if det == &#x27;L1&#x27;: 
            pcolor=&#x27;g&#x27;
            strain_whitenbp = strain_L1_whitenbp
            template_L1 = template_match.copy()
        else:
            pcolor=&#x27;r&#x27;
            strain_whitenbp = strain_H1_whitenbp
            template_H1 = template_match.copy()

        # -- Plot the result
        plt.figure(figsize=(10,8))
        plt.subplot(2,1,1)
        plt.plot(time-timemax, SNR, pcolor,label=det+&#x27; SNR(t)&#x27;)
        #plt.ylim([0,25.])
        plt.grid(&#x27;on&#x27;)
        plt.ylabel(&#x27;SNR&#x27;)
        plt.xlabel(&#x27;Time since {0:.4f}&#x27;.format(timemax))
        plt.legend(loc=&#x27;upper left&#x27;)
        plt.title(det+&#x27; matched filter SNR around event&#x27;)

        # zoom in
        plt.subplot(2,1,2)
        plt.plot(time-timemax, SNR, pcolor,label=det+&#x27; SNR(t)&#x27;)
        plt.grid(&#x27;on&#x27;)
        plt.ylabel(&#x27;SNR&#x27;)
        plt.xlim([-0.15,0.05])
        #plt.xlim([-0.3,+0.3])
        plt.grid(&#x27;on&#x27;)
        plt.xlabel(&#x27;Time since {0:.4f}&#x27;.format(timemax))
        plt.legend(loc=&#x27;upper left&#x27;)
        plt.savefig(FIGDIR / f&quot;{eventname}_H1_SNR.{plottype}&quot;)

        plt.figure(figsize=(10,8))
        plt.subplot(2,1,1)
        plt.plot(time-tevent,strain_whitenbp,pcolor,label=det+&#x27; whitened h(t)&#x27;)
        plt.plot(time-tevent,template_match,&#x27;k&#x27;,label=&#x27;Template(t)&#x27;)
        plt.ylim([-10,10])
        plt.xlim([-0.15,0.05])
        plt.grid(&#x27;on&#x27;)
        plt.xlabel(&#x27;Time since {0:.4f}&#x27;.format(timemax))
        plt.ylabel(&#x27;whitened strain (units of noise stdev)&#x27;)
        plt.legend(loc=&#x27;upper left&#x27;)
        plt.title(det+&#x27; whitened data around event&#x27;)

        plt.subplot(2,1,2)
        plt.plot(time-tevent,strain_whitenbp-template_match,pcolor,label=det+&#x27; resid&#x27;)
        plt.ylim([-10,10])
        plt.xlim([-0.15,0.05])
        plt.grid(&#x27;on&#x27;)
        plt.xlabel(&#x27;Time since {0:.4f}&#x27;.format(timemax))
        plt.ylabel(&#x27;whitened strain (units of noise stdev)&#x27;)
        plt.legend(loc=&#x27;upper left&#x27;)
        plt.title(det+&#x27; Residual whitened data after subtracting template around event&#x27;)
        plt.savefig(eventname+&quot;_&quot;+det+&quot;_matchtime.&quot;+plottype)
                 
        # -- Display PSD and template
        # must multiply by sqrt(f) to plot template fft on top of ASD:
        plt.figure(figsize=(10,6))
        template_f = np.absolute(template_fft)*np.sqrt(np.abs(datafreq)) / d_eff
        plt.loglog(datafreq, template_f, &#x27;k&#x27;, label=&#x27;template(f)*sqrt(f)&#x27;)
        plt.loglog(freqs, np.sqrt(data_psd),pcolor, label=det+&#x27; ASD&#x27;)
        plt.xlim(20, fs/2)
        plt.ylim(1e-24, 1e-20)
        plt.grid()
        plt.xlabel(&#x27;frequency (Hz)&#x27;)
        plt.ylabel(&#x27;strain noise ASD (strain/rtHz), template h(f)*rt(f)&#x27;)
        plt.legend(loc=&#x27;upper left&#x27;)
        plt.title(det+&#x27; ASD and template around event&#x27;)
        plt.savefig(eventname+&quot;_&quot;+det+&quot;_matchfreq.&quot;+plottype)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JApVzR4zOF2x9g8oMuhmo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>For detector H1, maximum at 1126259462.4395 with SNR = 18.6, D_eff = 814.44, horizon = 1889.6 Mpc
For detector L1, maximum at 1126259462.4324 with SNR = 13.2, D_eff = 999.74, horizon = 1650.6 Mpc
</span></code></pre></div><img src="/build/72ea2651abbbea06a21f9ec30941dbd5.png" alt="&lt;Figure size 1000x800 with 2 Axes&gt;"/><img src="/build/d9beb334985c50b8430e5db3d4d0bae0.png" alt="&lt;Figure size 1000x800 with 2 Axes&gt;"/><img src="/build/317d8aae836c29f4be0cf909d9370068.png" alt="&lt;Figure size 1000x600 with 1 Axes&gt;"/><img src="/build/9330fdcb86d493c7b1b97f5d7cbd6342.png" alt="&lt;Figure size 1000x800 with 2 Axes&gt;"/><img src="/build/f2e6095da263ab4a959a0aab3bc5073f.png" alt="&lt;Figure size 1000x800 with 2 Axes&gt;"/><img src="/build/28e0be896a36ed5784cdf2fc45f2e420.png" alt="&lt;Figure size 1000x600 with 1 Axes&gt;"/></div></div><div id="MWw32KugQS" class="relative group/block"><h3 id="notes-on-these-results" class="relative group"><span class="heading-text">Notes on these results</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#notes-on-these-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li><p>We make use of only one template, with a simple ASD estimate. The full analysis produces a Bayesian posterior result using many nearby templates. It does a more careful job estimating the ASD, and includes effects of uncertain calibration.</p></li><li><p>As a result, our parameters (SNR, masses, spins, D_eff) are somewhat different from what you will see in our papers.</p></li><li><p>We compute an “effective distance” D_eff. Is is NOT an estimate of the actual (luminosity) distance, which depends also on the source location and orbit orientation.</p></li><li><p>These distances are at non-zero redshift, so cosmological effects must be taken into account (neglected here). Since we estimate the BH masses using the phase evolution of the waveform, which has been redshifted, our masses are themselves “redshifted”. The true source masses must be corrected for this effect; they are smaller by a factor (1+z).</p></li></ul></div><div id="onAxw93jAp" class="relative group/block"><h2 id="make-sound-files" class="relative group"><span class="heading-text">Make sound files</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#make-sound-files" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Make wav (sound) files from the filtered, downsampled data, +-2s around the event.</p></div><div id="pTHrtaJoPx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># make wav (sound) files from the whitened data, +-2s around the event.

from scipy.io import wavfile

# function to keep the data within integer limits, and write to wavfile:
def write_wavfile(filename,fs,data):
    d = np.int16(data/np.max(np.abs(data)) * 32767 * 0.9)
    wavfile.write(filename,int(fs), d)

deltat_sound = 2.                     # seconds around the event

# index into the strain time series for this time interval:
indxd = np.where((time &gt;= tevent-deltat_sound) &amp; (time &lt; tevent+deltat_sound))

# write the files:
write_wavfile(eventname+&quot;_H1_whitenbp.wav&quot;,int(fs), strain_H1_whitenbp[indxd])
write_wavfile(eventname+&quot;_L1_whitenbp.wav&quot;,int(fs), strain_L1_whitenbp[indxd])

# re-whiten the template using the smoothed PSD; it sounds better!
template_p_smooth = whiten(template_p,psd_smooth,dt)

# and the template, sooming in on [-3,+1] seconds around the merger:
indxt = np.where((time &gt;= (time[0]+template_offset-deltat_sound)) &amp; (time &lt; (time[0]+template_offset+deltat_sound)))
write_wavfile(eventname+&quot;_template_whiten.wav&quot;,int(fs), template_p_smooth[indxt])
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="T4Y8pD-cVwhVR13FFWIeO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="pgi5vJO6OQ" class="relative group/block"><h3 id="listen-to-the-whitened-template-and-data" class="relative group"><span class="heading-text">Listen to the whitened template and data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#listen-to-the-whitened-template-and-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>With good headphones, you may be able to hear a faint thump in the middle; that’s our signal!</p></div><div id="N3oDkdjgei" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from IPython.display import Audio

fna = eventname+&quot;_template_whiten.wav&quot;
print(fna)
Audio(fna)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="S3CsFcW9UBKnzJCm28EzA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="XJx458rW9N" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fna = eventname+&quot;_H1_whitenbp.wav&quot;
print(fna)
Audio(fna)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PwIkPVtbnxPlYbl62BboL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="Iyo2YgEEkr" class="relative group/block"><h3 id="frequency-shift-the-audio-files" class="relative group"><span class="heading-text">Frequency shift the audio files</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#frequency-shift-the-audio-files" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We can enhance this by increasing the frequency;
this is the “audio” equivalent of the enhanced visuals that NASA employs on telescope images with “false color”.</p><p>The code below will shift the data up by 400 Hz (by taking an FFT, shifting/rolling the frequency series, then inverse fft-ing). The resulting sound file will be noticibly more high-pitched, and the signal will be easier to hear.</p></div><div id="blFs0kzWjd" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># function that shifts frequency of a band-passed signal
def reqshift(data,fshift=100,sample_rate=4096):
    &quot;&quot;&quot;Frequency shift the signal by constant
    &quot;&quot;&quot;
    x = np.fft.rfft(data)
    T = len(data)/float(sample_rate)
    df = 1.0/T
    nbins = int(fshift/df)
    # print T,df,nbins,x.real.shape
    y = np.roll(x.real,nbins) + 1j*np.roll(x.imag,nbins)
    y[0:nbins]=0.
    z = np.fft.irfft(y)
    return z

# parameters for frequency shift
fs = 4096
fshift = 400.
speedup = 1.
fss = int(float(fs)*float(speedup))

# shift frequency of the data
strain_H1_shifted = reqshift(strain_H1_whitenbp,fshift=fshift,sample_rate=fs)
strain_L1_shifted = reqshift(strain_L1_whitenbp,fshift=fshift,sample_rate=fs)

# write the files:
write_wavfile(eventname+&quot;_H1_shifted.wav&quot;,int(fs), strain_H1_shifted[indxd])
write_wavfile(eventname+&quot;_L1_shifted.wav&quot;,int(fs), strain_L1_shifted[indxd])

# and the template:
template_p_shifted = reqshift(template_p_smooth,fshift=fshift,sample_rate=fs)
write_wavfile(eventname+&quot;_template_shifted.wav&quot;,int(fs), template_p_shifted[indxt])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bOyaO7t7kBzVOqSi4H8yH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="t1OPCQaSAk" class="relative group/block"><h3 id="listen-to-the-frequency-shifted-template-and-data" class="relative group"><span class="heading-text">Listen to the frequency-shifted template and data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#listen-to-the-frequency-shifted-template-and-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="W9vFSEyVDG" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fna = eventname+&quot;_template_shifted.wav&quot;
print(fna)
Audio(fna)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="iv1vkvf2GrHACunkWatTw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="KMmjTRHyrf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fna = eventname+&quot;_H1_shifted.wav&quot;
print(fna)
Audio(fna)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MdmnjjChOWzGaKBKEtN0A" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="PPo4yqC2ac" class="relative group/block"><h2 id="data-segments" class="relative group"><span class="heading-text">Data segments</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-segments" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>As mentioned above, LIGO strain time series data has gaps (filled with NaNs) when the detectors are not taking valid (“science quality”) data. Analyzing these data requires the user to loop over “segments” of valid data stretches.  For details, see the <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/timeline/" class="">notes on segments</a> or <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/tutorials/" class="">introduction to LIGO data files</a>.</p><p>In the code below, we can check times around this event for gaps in the L1 data.  You are welcome to repeat this with H1 data, with files containing 4096 seconds of data, and with data sampled at 16384 Hz. All of the relevant files can be downloaded from <a target="_blank" rel="noreferrer" href="https://www.gwosc.org/events" class="">LOSC event pages.</a></p><p>We also unpack the DQ and HW injection bits to check what their values are.</p></div><div id="fv9PpR3ABZ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">data_segments = 1
if data_segments:
    # read in the data at 4096 Hz:
    # fn = &#x27;L-L1_LOSC_4_V1-1126259446-32.hdf5&#x27;
    strain, time, chan_dict = rl.loaddata(fn_L1, &#x27;H1&#x27;)

    print(&quot;Contents of all the key, value pairs in chan_dict&quot;)
    for keys,values in chan_dict.items():
        print(keys)
        print(values)

    print(&#x27;Total number of non-NaNs in these data = &#x27;,np.sum(~np.isnan(strain)))
    print(&#x27;GPS start, GPS stop and length of  all data in this file = &#x27;,time[0], time[-1],len(strain))

    # select the level of data quality; default is &quot;DATA&quot; but &quot;CBC_CAT3&quot; is a conservative choice:
    DQflag = &#x27;CBC_CAT3&#x27;
    # readligo.py method for computing segments (start and stop times with continuous valid data):
    segment_list = rl.dq_channel_to_seglist(chan_dict[DQflag])
    print(&#x27;Number of segments with DQflag&#x27;,DQflag,&#x27; = &#x27;,len(segment_list))

    # loop over seconds and print out start, stop and length:
    iseg = 0
    for segment in segment_list:
        time_seg = time[segment]
        seg_strain = strain[segment]
        print(&#x27;GPS start, GPS stop and length of segment&#x27;,iseg, \
            &#x27;in this file = &#x27;,time_seg[0], time_seg[-1], len(seg_strain))
        iseg = iseg+1
        # here is where you would insert code to analyze the data in this segment.

    # now look at segments with no CBC hardware injections:
    DQflag = &#x27;NO_CBC_HW_INJ&#x27;
    segment_list = rl.dq_channel_to_seglist(chan_dict[&#x27;NO_CBC_HW_INJ&#x27;])
    print(&#x27;Number of segments with DQflag&#x27;,DQflag,&#x27; = &#x27;,len(segment_list))
    iseg = 0
    for segment in segment_list:
        time_seg = time[segment]
        seg_strain = strain[segment]
        print(&#x27;GPS start, GPS stop and length of segment&#x27;,iseg, \
            &#x27;in this file = &#x27;,time_seg[0], time_seg[-1], len(seg_strain))
        iseg = iseg+1
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HPQ_4QQsAg4vTep4Cjzur" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Contents of all the key, value pairs in chan_dict
DATA
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
CBC_CAT1
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
CBC_CAT2
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
CBC_CAT3
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
BURST_CAT1
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
BURST_CAT2
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
BURST_CAT3
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
NO_CBC_HW_INJ
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
NO_BURST_HW_INJ
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
NO_DETCHAR_HW_INJ
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
NO_CW_HW_INJ
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
NO_STOCH_HW_INJ
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
DEFAULT
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Total number of non-NaNs in these data =  131072
GPS start, GPS stop and length of  all data in this file =  1126259446.0 1126259477.9997559 131072
Number of segments with DQflag CBC_CAT3  =  1
GPS start, GPS stop and length of segment 0 in this file =  1126259446.0 1126259477.9997559 131072
Number of segments with DQflag NO_CBC_HW_INJ  =  1
GPS start, GPS stop and length of segment 0 in this file =  1126259446.0 1126259477.9997559 131072
</span></code></pre></div></div></div><div id="sdsl9cMoH8" class="relative group/block"><h2 id="comments-on-sampling-rate" class="relative group"><span class="heading-text">Comments on sampling rate</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#comments-on-sampling-rate" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>LIGO data are acquired at 16384 Hz (2^14 Hz). Here, we have been working with data downsampled to 4096 Hz, to save on download time, disk space, and memory requirements.</p><p>This is entirely sufficient for signals with no frequency content above f_Nyquist = fs/2 = 2048 Hz, such as signals from higher-mass binary black hole systems; the frequency at which the merger begins (at the innermost stable circular orbit) for equal-mass, spinless black holes is roughly 1557 Hz * (2.8/M_tot), where 2.8 solar masses is the total mass of a canonical binary neutron star system.</p><p>If, however, you are interested in signals with frequency content above 2048 Hz, you need the data sampled at the full rate of 16384 Hz.</p></div><div id="fotc8ByL1j" class="relative group/block"><h2 id="construct-a-csv-file-containing-the-whitened-data-and-template" class="relative group"><span class="heading-text">Construct a csv file containing the whitened data and template</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#construct-a-csv-file-containing-the-whitened-data-and-template" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="O0wAN68Ll8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># time vector around event
times = time-tevent
# zoom in on [-0.2,0.05] seconds around event
irange = np.nonzero((times &gt;= -0.2) &amp; (times &lt; 0.05))
# construct a data structure for a csv file:
dat = [times[irange], strain_H1_whitenbp[irange],strain_L1_whitenbp[irange],
      template_H1[irange],template_L1[irange] ]
datcsv = np.array(dat).transpose()
# make a csv filename, header, and format
fncsv = eventname+&#x27;_data.csv&#x27;
headcsv = eventname+&#x27; time-&#x27;+str(tevent)+ \
    &#x27; (s),H1_data_whitened,L1_data_whitened,H1_template_whitened,L1_template_whitened&#x27;
fmtcsv = &quot;,&quot;.join([&quot;%10.6f&quot;] * 5)
np.savetxt(fncsv, datcsv, fmt=fmtcsv, header=headcsv)

print(&quot;Wrote whitened data to file {0}&quot;.format(fncsv))
print(&quot;You can download this file by clicking &#x27;jupyter&#x27; in the top left corner, or using the &#x27;data&#x27; menu in Azure.&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="WKNGwc_kyxJYeJivVFO8y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Wrote whitened data to file GW150914_data.csv
You can download this file by clicking &#x27;jupyter&#x27; in the top left corner, or using the &#x27;data&#x27; menu in Azure.
</span></code></pre></div></div></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">HW3 – LIGO</div>HW3 – LIGO</div></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-N2N6M3QH.js"/><link rel="modulepreload" href="/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-ZJZ4LRPY.js"/><link rel="modulepreload" href="/build/_shared/chunk-KGDL62ZF.js"/><link rel="modulepreload" href="/build/routes/$-23AHH5XS.js"/><script>window.__remixContext = {"url":"/losc-event-tutorial","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.3","options":{},"nav":[],"actions":[],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"HW3 – LIGO","authors":[{"nameParsed":{"literal":"Ligo Scientific Collaboration (LSC) and Ji Su Youn","given":"Ligo Scientific Collaboration (LSC)","non_dropping_particle":"and","family":"Ji Su Youn"},"name":"Ligo Scientific Collaboration (LSC) and Ji Su Youn","id":"contributors-myst-generated-uid-0"}],"toc":[{"file":"README.md"},{"file":"notebooks/LOSC_Event_tutorial.ipynb","title":"LOSC Event Tutorial"}],"thumbnail":"/build/4ca599c12ad03712a9fa6f4c109e48cc.svg","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"losc-event-tutorial","title":"BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"version":2,"myst":"1.6.3","options":{},"nav":[],"actions":[],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"HW3 – LIGO","authors":[{"nameParsed":{"literal":"Ligo Scientific Collaboration (LSC) and Ji Su Youn","given":"Ligo Scientific Collaboration (LSC)","non_dropping_particle":"and","family":"Ji Su Youn"},"name":"Ligo Scientific Collaboration (LSC) and Ji Su Youn","id":"contributors-myst-generated-uid-0"}],"toc":[{"file":"README.md"},{"file":"notebooks/LOSC_Event_tutorial.ipynb","title":"LOSC Event Tutorial"}],"thumbnail":"/build/4ca599c12ad03712a9fa6f4c109e48cc.svg","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"losc-event-tutorial","title":"BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":2,"kind":"Notebook","sha256":"74d8089b7fa8955c4e4aa0c91293e44d0a67e2442fe1e11b0e084ecc436df687","slug":"losc-event-tutorial","location":"/notebooks/LOSC_Event_tutorial.ipynb","dependencies":[],"frontmatter":{"title":"BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Ligo Scientific Collaboration (LSC) and Ji Su Youn","given":"Ligo Scientific Collaboration (LSC)","non_dropping_particle":"and","family":"Ji Su Youn"},"name":"Ligo Scientific Collaboration (LSC) and Ji Su Youn","id":"contributors-myst-generated-uid-0"}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"exports":[{"format":"ipynb","filename":"LOSC_Event_tutorial.ipynb","url":"/build/LOSC_Event_tutorial-d19817affcea60da1b31aa1acce073f8.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Ensure the repo root (one level up from notebooks/) is on sys.path\nimport sys, os\nfrom pathlib import Path\nREPO_ROOT = Path.cwd().parent\nif str(REPO_ROOT) not in sys.path:\n    sys.path.insert(0, str(REPO_ROOT))\n","key":"sEw1Ob2vuM"},{"type":"output","id":"4Hc1oTn3vD1qMM9NBGGWt","data":[],"key":"CJUWCNW5xp"}],"key":"GHjIp7oKDz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pathlib import Path\n\n# Folders relative to the repo root\nDATADIR  = REPO_ROOT / \"data\"\nFIGDIR   = REPO_ROOT / \"figures\"\nAUDIODIR = REPO_ROOT / \"audio\"\n\nFIGDIR.mkdir(exist_ok=True)\nAUDIODIR.mkdir(exist_ok=True)\n","key":"FCMsDD41jC"},{"type":"output","id":"2qNlrLAP0c-6e4jf86j4Z","data":[],"key":"UInq3Q2gsQ"}],"key":"tlhcSsRkac"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from ligotools.utils import whiten, write_wavfile, reqshift, plot_psds\nimport json\n\nfnjson = DATADIR / \"BBH_events_v3.json\"\nevents = json.load(open(fnjson, \"r\"))\n\neventname = \"GW150914\"           # or whichever event you need\nevent     = events[eventname]\n\nfn_H1       = DATADIR / event[\"fn_H1\"]\nfn_L1       = DATADIR / event[\"fn_L1\"]\nfn_template = DATADIR / event[\"fn_template\"]\n","key":"slF7YwudoF"},{"type":"output","id":"mqIqld6PwrDydnQtdiyuu","data":[],"key":"UYPa7ovFHL"}],"key":"cETRQRitVR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pathlib import Path\nFIGDIR = Path(\"figures\"); FIGDIR.mkdir(exist_ok=True)\nAUDIODIR = Path(\"audio\");  AUDIODIR.mkdir(exist_ok=True)\nDATADIR = Path(\"data\")     # already exists\n","key":"anvZuZqEcm"},{"type":"output","id":"K3jokfkh1QztZx-9yCbdF","data":[],"key":"oUbVaR27At"}],"key":"IREZpBO3md"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This repository is public so that Binder can find it. All code and data is based on the original ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZnLYGav0Cu"},{"type":"link","url":"https://github.com/losc-tutorial/LOSC_Event_tutorial","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LIGO Center for Open Science Tutorial Repository","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zlmb687Qto"}],"urlSource":"https://github.com/losc-tutorial/LOSC_Event_tutorial","error":true,"key":"aheeOwdVGz"},{"type":"text","value":". This repository is a class exercise that restructures the original LIGO code for improved reproducibility, as a homework assignment for the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZhYJfnd1zy"},{"type":"link","url":"https://ucb-stat-159-s23.github.io/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spring 2023 installment of UC Berkeley’s Stat 159/259 course, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T0zCYZ0MVd"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reproducible and Collaborative Data Science","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hAzg4geqZ5"}],"key":"LvTKszcCSz"}],"urlSource":"https://ucb-stat-159-s23.github.io/","key":"XZhEDpBxhZ"},{"type":"text","value":". Authorship of the original analysis code rests with the LIGO collaboration.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VqNEKKwo47"}],"key":"ofWjPs1w10"}],"key":"X6TQJOzNGJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GQju6Ah2qY"}],"identifier":"binary-black-hole-signals-in-ligo-open-data","label":"BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA","html_id":"binary-black-hole-signals-in-ligo-open-data","implicit":true,"key":"XP9lu4xp9g"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Version 1.64, 2022 July 05","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HoZMa9e4gG"}],"key":"gv0NfCCd3g"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Welcome! This IPython notebook (or associated python script LOSC_Event_tutorial.py ) will go through some typical signal processing tasks on strain time-series data associated with the LIGO Event data releases from the LIGO Open Science Center (LOSC):","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gTqovR5Uqx"}],"key":"rfdojHTmwB"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Find events at ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DyOc79xUob"},{"type":"link","url":"https://www.gwosc.org/eventapi/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"https://​www​.gwosc​.org​/eventapi/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sDc6EK4GsZ"}],"urlSource":"https://www.gwosc.org/eventapi/","key":"LURmed4VJX"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JGypG6jdjh"}],"key":"pp14Kd9IHM"}],"key":"kzCGgELXiu"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Run this tutorial with Binder using the link on the ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XrepfLDWeO"},{"type":"link","url":"https://www.gwosc.org/tutorials/","children":[{"type":"text","value":"tutorials","key":"ow5hzLnj1m"}],"urlSource":"https://www.gwosc.org/tutorials/","key":"Ijhedx38uY"},{"type":"text","value":" page.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CZ2PPHaKMu"}],"key":"ftGNLB5CqP"}],"key":"rWPfqHUroZ"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If you are running this tutorial on your own computer, see the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"V7GbBGh0D2"},{"type":"link","url":"#Download-the-data","children":[{"type":"text","value":"Download","key":"HjJPYFXWUz"}],"urlSource":"#Download-the-data","key":"WSlanIPPYV"},{"type":"text","value":" section below.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eR7gNtUSsA"}],"key":"riEEYH8s8v"}],"key":"BwJyLQAD71"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"After setting the desired “eventname” below, you can just run the full notebook.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"pSbrhwtKOE"}],"key":"c95jLZ4n7z"}],"key":"KiyzN5mqAA"}],"key":"KBgKrNoakl"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Questions, comments, suggestions, corrections, etc: ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"AmrFUovATU"},{"type":"link","url":"https://ask.igwn.org","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"ask.igwn.org","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"htWBwr2qYm"}],"urlSource":"https://ask.igwn.org","key":"BKX4lXqxjO"}],"key":"geWhYiy8mR"}],"key":"ixIyIKWYPw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This tutorial is intended for educational purposes.  The code shown here is not used to produce results papers published by the LIGO Scientific Collaboration, which instead rely on special purpose analysis software packages.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KcJCP17Ar5"}],"identifier":"this-tutorial-is-intended-for-educational-purposes-the-code-shown-here-is-not-used-to-produce-results-papers-published-by-the-ligo-scientific-collaboration-which-instead-rely-on-special-purpose-analysis-software-packages","label":"This tutorial is intended for educational purposes.  The code shown here is not used to produce results papers published by the LIGO Scientific Collaboration, which instead rely on special purpose analysis software packages.","html_id":"this-tutorial-is-intended-for-educational-purposes-the-code-shown-here-is-not-used-to-produce-results-papers-published-by-the-ligo-scientific-collaboration-which-instead-rely-on-special-purpose-analysis-software-packages","implicit":true,"key":"kH8B0x4Ryx"},{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"For publicly available, gravitational-wave software analysis packages that are used to produce LSC and Virgo Collaboration results papers, see ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jLkqreyZIg"},{"type":"link","url":"https://www.gwosc.org/software/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​www​.gwosc​.org​/software/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KBXEqj1gMa"}],"urlSource":"https://www.gwosc.org/software/","key":"X5w1Jw8s7N"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HXo5tHzIG8"}],"identifier":"for-publicly-available-gravitational-wave-software-analysis-packages-that-are-used-to-produce-lsc-and-virgo-collaboration-results-papers-see-https-www-gwosc-org-software","label":"For publicly available, gravitational-wave software analysis packages that are used to produce LSC and Virgo Collaboration results papers, see https://www.gwosc.org/software/.","html_id":"for-publicly-available-gravitational-wave-software-analysis-packages-that-are-used-to-produce-lsc-and-virgo-collaboration-results-papers-see-https-www-gwosc-org-software","implicit":true,"key":"Q8Fdn4n5Z8"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For technical notes on this tutorial, see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RldxH8HeIQ"},{"type":"link","url":"https://www.gwosc.org/bbh_tutorial_notes/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.gwosc​.org​/bbh​_tutorial​_notes/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ptiSkF1yjW"}],"urlSource":"https://www.gwosc.org/bbh_tutorial_notes/","key":"zBavLUSae3"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZPe8hSXB05"}],"identifier":"for-technical-notes-on-this-tutorial-see-https-www-gwosc-org-bbh-tutorial-notes","label":"For technical notes on this tutorial, see https://www.gwosc.org/bbh_tutorial_notes/.","html_id":"for-technical-notes-on-this-tutorial-see-https-www-gwosc-org-bbh-tutorial-notes","implicit":true,"key":"B7OHI9dtbi"}],"key":"OhIkh4Tqbo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table of Contents","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"knGLTg9pys"}],"identifier":"table-of-contents","label":"Table of Contents","html_id":"table-of-contents","implicit":true,"key":"rdR3Hu0x19"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Intro to signal processing","key":"M4zSKqeWuw"}],"identifier":"intro-to-signal-processing","label":"Intro-to-signal-processing","kind":"heading","template":"{name}","resolved":true,"html_id":"intro-to-signal-processing","key":"y2LAjV8d2v"}],"key":"B35HYe6RAQ"}],"key":"X0YNMIm3ZH"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Download the data","key":"krNcDUTrYq"}],"identifier":"download-the-data-on-a-computer-with-a-python-installation","label":"Download-the-data-on-a-computer-with-a-python-installation","kind":"heading","template":"{name}","resolved":true,"html_id":"download-the-data-on-a-computer-with-a-python-installation","key":"pX6piwFAOt"}],"key":"w0Ss63XHg3"}],"key":"Vwy5mDe0zx"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Set the event name to choose event and the plot type","key":"A6mz6qerHB"}],"identifier":"set-the-event-name-to-choose-event-and-the-plot-type","label":"Set-the-event-name-to-choose-event-and-the-plot-type","kind":"heading","template":"{name}","resolved":true,"html_id":"set-the-event-name-to-choose-event-and-the-plot-type","key":"rar2zHxgwF"}],"key":"yfCgoypMsv"}],"key":"JjP9yt8cDG"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Read in the data","key":"fyqVVV2Ww5"}],"identifier":"read-in-the-data","label":"Read-in-the-data","kind":"heading","template":"{name}","resolved":true,"html_id":"read-in-the-data","key":"JV1C84DaGT"}],"key":"zlWogr1XB4"}],"key":"HH1pjwdXsS"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#Plot-the-Amplitude-Spectral-Density-(ASD)","children":[{"type":"text","value":"Plot the ASD","key":"GNsCCOGaHS"}],"urlSource":"#Plot-the-Amplitude-Spectral-Density-(ASD)","key":"LZRL3TmNfV"}],"key":"SVwvRjmxpp"}],"key":"J8Nn2E42mI"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"#Binary-Neutron-Star-(BNS)-detection-range","children":[{"type":"text","value":"Binary Neutron Star detection range","key":"ejk6ZFhyLm"}],"urlSource":"#Binary-Neutron-Star-(BNS)-detection-range","key":"KIQzBmSsVW"}],"key":"vvCKG5WAb9"}],"key":"ZXzewtSe79"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Whitening","key":"ZEbynsnnYU"}],"identifier":"whitening","label":"Whitening","kind":"heading","template":"{name}","resolved":true,"html_id":"whitening","key":"uwvaKwQLqQ"}],"key":"Fv7uDyrmVn"}],"key":"LOPvpf7gmd"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Spectrograms","key":"t8BieJ26TZ"}],"identifier":"spectrograms","label":"Spectrograms","kind":"heading","template":"{name}","resolved":true,"html_id":"spectrograms","key":"LpQnfjkHQs"}],"key":"SBRieZyxCI"}],"key":"wDxISA73Ca"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Waveform Template","key":"IsH3teEaci"}],"identifier":"waveform-template","label":"Waveform-Template","kind":"heading","template":"{name}","resolved":true,"html_id":"waveform-template","key":"OOkYTxO2Wo"}],"key":"MxVxD488J2"}],"key":"oqj3qMAi3t"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Matched filtering to find the signal","key":"u2u6vJf3lk"}],"identifier":"matched-filtering-to-find-the-signal","label":"Matched-filtering-to-find-the-signal","kind":"heading","template":"{name}","resolved":true,"html_id":"matched-filtering-to-find-the-signal","key":"JXw3GYFksw"}],"key":"AsYldumojm"}],"key":"ujLk0jDkZx"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Make sound Files","key":"rGgm02zg2B"}],"identifier":"make-sound-files","label":"Make-sound-files","kind":"heading","template":"{name}","resolved":true,"html_id":"make-sound-files","key":"da7PTiYMeI"}],"key":"gPcCiPFX8B"}],"key":"o3jXBYHaCE"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"crossReference","children":[{"type":"text","value":"Data segments","key":"tVyQaJaypU"}],"identifier":"data-segments","label":"Data-segments","kind":"heading","template":"{name}","resolved":true,"html_id":"data-segments","key":"FuAK5M7RBK"}],"key":"jQXTZGA5O4"}],"key":"TMM7H5Updz"}],"key":"gns2klVVzz"}],"key":"EGSyMtPYpg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Intro to signal processing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dapg2rXCCP"}],"identifier":"intro-to-signal-processing","label":"Intro to signal processing","html_id":"intro-to-signal-processing","implicit":true,"key":"Vgjp3p3zWX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial assumes that you are comfortable with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RIjCHn2hCK"},{"type":"link","url":"https://www.python.org/","children":[{"type":"text","value":"python","key":"CxG1yXo7yV"}],"urlSource":"https://www.python.org/","key":"CMHikFHQK4"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UFrKJ5kOH2"}],"key":"HfHUzcTpMc"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This tutorial also assumes that you know a bit about signal processing of digital time series data (or want to learn!). This includes power spectral densities, spectrograms, digital filtering, whitening, audio manipulation. This is a vast and complex set of topics, but we will cover many of the basics in this tutorial.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jZvdU6dFhk"}],"key":"txxZ4UkQ7K"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"If you are a beginner, here are some resources from the web:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JSCyNY01Kx"}],"key":"j2S3w6Ihq4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"http://101science.com/dsp.htm","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"http://​101science​.com​/dsp​.htm","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"k9vlfvcxph"}],"urlSource":"http://101science.com/dsp.htm","key":"dwezSExMkF"}],"key":"BkArD9pxfD"}],"key":"qwfiIlvulS"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://www.coursera.org/course/dsp","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"https://​www​.coursera​.org​/course​/dsp","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XZLjudf4lP"}],"urlSource":"https://www.coursera.org/course/dsp","key":"lEm0WZzvHD"}],"key":"E0K2iH47SM"}],"key":"ZVn6ts4py5"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://georgemdallas.wordpress.com/2014/05/14/wavelets-4-dummies-signal-processing-fourier-transforms-and-heisenberg/","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"https://​georgemdallas​.wordpress​.com​/2014​/05​/14​/wavelets​-4​-dummies​-signal​-processing​-fourier​-transforms​-and​-heisenberg/","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HAWErFK7Ew"}],"urlSource":"https://georgemdallas.wordpress.com/2014/05/14/wavelets-4-dummies-signal-processing-fourier-transforms-and-heisenberg/","key":"LwpTTCa21q"}],"key":"j6lKJuzIDA"}],"key":"WBnAi2MWO0"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Signal_processing","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Signal processing","key":"voMX1AS6ey"}],"urlSource":"https://en.wikipedia.org/wiki/Signal_processing","data":{"page":"Signal_processing","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"wzQ3uJKfAp"}],"key":"TVuvDW6Gnu"}],"key":"WUiSLmTobJ"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Spectral_density","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Spectral density","key":"S6YZK0Gmt5"}],"urlSource":"https://en.wikipedia.org/wiki/Spectral_density","data":{"page":"Spectral_density","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"ER1pyuLBEC"}],"key":"d5qVxiva9V"}],"key":"a1D0NnnStR"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Spectrogram","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Spectrogram","key":"hEavMa18Pm"}],"urlSource":"https://en.wikipedia.org/wiki/Spectrogram","data":{"page":"Spectrogram","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"xuDoE9Hhtf"}],"key":"WTe4mJk0OX"}],"key":"if0GP2hIjJ"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"http://greenteapress.com/thinkdsp/","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"http://​greenteapress​.com​/thinkdsp/","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"OfVXASZrTF"}],"urlSource":"http://greenteapress.com/thinkdsp/","key":"xzjfHIpiho"}],"key":"Wnl6jNB1Rk"}],"key":"ibSCuetpVC"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Digital_filter","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Digital filter","key":"aRvZQPZrkC"}],"urlSource":"https://en.wikipedia.org/wiki/Digital_filter","data":{"page":"Digital_filter","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"vvbijwptjt"}],"key":"kuJDR9kR3p"}],"key":"qQmgEFHtNz"}],"key":"NdzF59UJpp"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"And, well, lots more on the web!","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"AWsU5gv2pc"}],"key":"tUSfn6KP0r"}],"key":"bOoHUAZkva"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Download the data on a computer with a python installation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CDlrpFwPLQ"}],"identifier":"download-the-data-on-a-computer-with-a-python-installation","label":"Download the data on a computer with a python installation","html_id":"download-the-data-on-a-computer-with-a-python-installation","implicit":true,"key":"o2DhOHQuQ7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If you are using a pre-configured setup (eg, in binder), great! You don’t have to download or set up anything.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rt5w6LO0pj"}],"key":"lZ2Q8GceHS"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Otherwise, to begin, get the necessary files, by downloading the zip file and unpacking it into single directory:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"D8Z5JS4NxJ"}],"key":"aS5Zuc7MJr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/losc-tutorial/LOSC_Event_tutorial/archive/refs/heads/master.zip","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"LOSC​_Event​_tutorial​.zip","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ueQsxmv2gT"}],"urlSource":"https://github.com/losc-tutorial/LOSC_Event_tutorial/archive/refs/heads/master.zip","error":true,"key":"UTM7MqPJUV"}],"key":"SqnXeNcLhP"}],"key":"UCQe4b5oPH"}],"key":"GbCMWFJrvy"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"This zip file contains:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RDCOAJosom"}],"key":"P3aULGqdPn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"this IPython notebook LOSC_Event_tutorial.ipynb code.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rY8fJc7cZv"}],"key":"cMkkpQh3Ws"}],"key":"Uoele9XVdl"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"python code for reading LOSC data files: readligo.py.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XKYd7VAJ4u"}],"key":"prqi9VpX0W"}],"key":"O8XgVUwUXF"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"the event data files (32s sampled at 4096 Hz, in hdf5 format, for both LIGO detectors).","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"eTkxUYyF20"}],"key":"mv9uhbg7qF"}],"key":"sALitjXJaG"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"waveform templates (32s sampled at 4096 Hz, in hdf5 format, for both plus and cross polarizations).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ATzr8bSAVz"}],"key":"WedHYMfVwW"}],"key":"ToutOe25yg"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"a parameter file in json format","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ylyrwwCwpa"}],"key":"rWawhPJCzS"}],"key":"w6dQeNmFu7"}],"key":"BBvgrgXbLS"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"You will also need a python installation with a few packages (","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"QWrkQeseyC"},{"type":"link","url":"http://www.numpy.org/","children":[{"type":"text","value":"numpy","key":"PuHhRHEdue"}],"urlSource":"http://www.numpy.org/","key":"Ukgq93UKi7"},{"type":"text","value":", ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"T3Jwg0edPU"},{"type":"link","url":"http://matplotlib.org/","children":[{"type":"text","value":"matplotlib","key":"ZQQfLCdFuY"}],"urlSource":"http://matplotlib.org/","key":"e5O41nTJuF"},{"type":"text","value":", ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"cuFvE7FssS"},{"type":"link","url":"https://www.scipy.org/","children":[{"type":"text","value":"scipy","key":"Fo6o66f7Fv"}],"urlSource":"https://www.scipy.org/","key":"SVcc4Aw9qL"},{"type":"text","value":", ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"tsdHhuA7QQ"},{"type":"link","url":"http://www.h5py.org/","children":[{"type":"text","value":"h5py","key":"HYU3R8wqE2"}],"urlSource":"http://www.h5py.org/","key":"dkvifX0Sfz"},{"type":"text","value":",  ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"YIF5bMzICT"},{"type":"link","url":"https://docs.python.org/2/library/json.html","children":[{"type":"text","value":"json","key":"OuCeBnK578"}],"urlSource":"https://docs.python.org/2/library/json.html","key":"Jhcl8bhi0x"},{"type":"text","value":" ).","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"KHe9LZ9LQM"}],"key":"kNXBdK5yPN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For hints on software installation, see ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"eevKI5XLLi"},{"type":"link","url":"https://www.gwosc.org/tutorial00/","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"https://​www​.gwosc​.org​/tutorial00/","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ALSQWiKvCB"}],"urlSource":"https://www.gwosc.org/tutorial00/","key":"NqXZ1Gioyu"}],"key":"Sv8rzKo4QJ"}],"key":"eVrbVKfCtM"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The tutorial should work on python 2.6 and above, including python 3, as well as in recent versions of IPython.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"vC2yZ2ovCL"}],"key":"yDoIlTKRqb"}],"key":"Ov47sznwko"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"O8kBmawysG"},{"type":"emphasis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"might","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"LwDNJulFsw"}],"key":"QFLcNChmt8"},{"type":"text","value":" see Warning or ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"dc7d3tAEoz"},{"type":"inlineCode","value":"FutureWarning","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"RhUqgwmz2X"},{"type":"text","value":" messages, which tend to be associated with different versions of python, Ipython, numpy, etc. Hopefully they can be ignored!","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"GvtY8qbdGq"}],"key":"JUBBqd46db"}],"key":"poeQZNdWg2"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"the filetype “hdf5” means the data are in hdf5 format:\n","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"uKpMHlXqsb"},{"type":"link","url":"https://www.hdfgroup.org/HDF5/","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"https://​www​.hdfgroup​.org​/HDF5/","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"zzkZXz8q0A"}],"urlSource":"https://www.hdfgroup.org/HDF5/","key":"Nn10EBYC0A"}],"key":"LGrQbj4nNX"}],"key":"uobGAlraCK"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"NOTE: GPS time is number of seconds since Jan 6, 1980 GMT. See ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"ZtNalhbLaE"},{"type":"link","url":"http://www.oc.nps.edu/oc2902w/gps/timsys.html","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"http://​www​.oc​.nps​.edu​/oc2902w​/gps​/timsys​.html","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"QlUyo9OLpJ"}],"urlSource":"http://www.oc.nps.edu/oc2902w/gps/timsys.html","key":"IlNNPtsMcd"},{"type":"text","value":" or ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"HHjqKn1WyL"},{"type":"link","url":"https://www.gwosc.org/gps/","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"https://​www​.gwosc​.org​/gps/","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"zJqn7tbCsj"}],"urlSource":"https://www.gwosc.org/gps/","key":"yoVeDn1ri0"}],"key":"NHDEkpYRo8"}],"key":"dHntVyheNl"}],"key":"kYu7U7Akaj"}],"key":"t7OjAvsOzv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Set the event name to choose event and the plot type","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sdgY5Fed0W"}],"identifier":"set-the-event-name-to-choose-event-and-the-plot-type","label":"Set the event name to choose event and the plot type","html_id":"set-the-event-name-to-choose-event-and-the-plot-type","implicit":true,"key":"wSl7HZHnog"}],"key":"tOxUtZO9Pt"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"#-- SET ME   Tutorial should work with most binary black hole events\n#-- Default is no event selection; you MUST select one to proceed.\neventname = ''\neventname = 'GW150914' \n#eventname = 'GW151226' \n#eventname = 'LVT151012'\n#eventname = 'GW170104'\n\n# want plots?\nmake_plots = 1\nplottype = \"png\"\n#plottype = \"pdf\"","key":"A3ZGMvsiew"},{"type":"output","id":"NvAFQXwUgKo0FJnKL_8Bw","data":[],"key":"lO58RkwpqN"}],"key":"IP6nZRvrez"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Standard python numerical analysis imports:\nimport numpy as np\nfrom scipy.signal import windows\nfrom scipy.interpolate import interp1d\nfrom scipy.signal import butter, filtfilt, iirdesign, zpk2tf, freqz\nimport h5py\nimport json\n\n# the IPython magic below must be commented out in the .py file, since it doesn't work there.\n%matplotlib inline\n%config InlineBackend.figure_format = 'retina'\nimport matplotlib.pyplot as plt\nimport matplotlib.mlab as mlab\n\n# LIGO-specific readligo.py \nfrom ligotools import readligo as rl\n\n# Load LIGO strain data\nstrain_H1, time_H1, chan_H1 = rl.loaddata(fn_H1, 'H1')\nstrain_L1, time_L1, chan_L1 = rl.loaddata(fn_L1, 'L1')\n\n# quick summary\nprint(\"H1:\", len(strain_H1), \"points,\", \"L1:\", len(strain_L1), \"points\")\n# you might get a matplotlib warning here; you can ignore it.","key":"J2aWUsDV6O"},{"type":"output","id":"Y-_4YpuwDFoXoZfOT3l2a","data":[{"name":"stdout","output_type":"stream","text":"H1: 131072 points, L1: 131072 points\n"}],"key":"ITSK6g7xnd"}],"key":"zlKhC5gwFC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read the event properties from a local json file (download in advance):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T1SSUqFqah"}],"identifier":"read-the-event-properties-from-a-local-json-file-download-in-advance","label":"Read the event properties from a local json file (download in advance):","html_id":"read-the-event-properties-from-a-local-json-file-download-in-advance","implicit":true,"key":"ylGEQ32FNi"}],"key":"y9wFdKrocc"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Read the event properties from a local json file\nfnjson = \"../data/BBH_events_v3.json\"\ntry:\n    events = json.load(open(fnjson,\"r\"))\nexcept IOError:\n    print(\"Cannot find resource file \"+fnjson)\n    print(\"You can download it from https://www.gwosc.org/s/events/\"+fnjson)\n    print(\"Quitting.\")\n    quit()\n\n# did the user select the eventname ?\neventname = \"GW150914\"\n\ntry: \n    events[eventname]\nexcept:\n    print('You must select an eventname that is in '+fnjson+'! Quitting.')\n    quit()","key":"tIMomoAUar"},{"type":"output","id":"ml3zUJgotm4B9s_XAk6GK","data":[],"key":"tkx24A5Elq"}],"key":"QMCLXaipsE"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Extract the parameters for the desired event:\nevent = events[eventname]\nfn_H1 = event['fn_H1']              # File name for H1 data\nfn_L1 = event['fn_L1']              # File name for L1 data\nfn_template = event['fn_template']  # File name for template waveform\nfs = event['fs']                    # Set sampling rate\ntevent = event['tevent']            # Set approximate event GPS time\nfband = event['fband']              # frequency band for bandpassing signal\nprint(\"Reading in parameters for event \" + event[\"name\"])\nprint(event)","key":"E740bMFbQr"},{"type":"output","id":"zBTeo1W8gFznpVbsAPdty","data":[{"name":"stdout","output_type":"stream","text":"Reading in parameters for event GW150914\n{'name': 'GW150914', 'fn_H1': 'H-H1_LOSC_4_V2-1126259446-32.hdf5', 'fn_L1': 'L-L1_LOSC_4_V2-1126259446-32.hdf5', 'fn_template': 'GW150914_4_template.hdf5', 'fs': 4096, 'tevent': 1126259462.44, 'utcevent': '2015-09-14T09:50:45.44', 'm1': 41.743, 'm2': 29.237, 'a1': 0.355, 'a2': -0.769, 'approx': 'lalsim.SEOBNRv2', 'fband': [43.0, 300.0], 'f_min': 10.0}\n"}],"key":"AAmhhTnQqd"}],"key":"xn9PjOg6vt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nprint(os.getcwd())\nprint(os.path.exists(fn_H1))\nprint(os.path.exists(fn_L1))\nprint(os.path.exists(fn_template))\n","key":"PkP0kY3f7Z"},{"type":"output","id":"cT3qNKGoNtXwZv6HNVhY3","data":[{"name":"stdout","output_type":"stream","text":"/home/jovyan/hw3-kayajuicee/notebooks\nFalse\nFalse\nFalse\n"}],"key":"BqJPSlcCB0"}],"key":"rNOaWt8HnB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read in the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZQj2MoYmAd"}],"identifier":"read-in-the-data","label":"Read in the data","html_id":"read-in-the-data","implicit":true,"key":"U5U7T8PSZq"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We will make use of the data, and waveform template, defined above.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XFozbiksb2"}],"key":"A4rc7oqZV9"}],"key":"j9IxHudjci"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"from ligotools import readligo as rl\n\n# File paths (pointing to your data folder)\nfn_H1 = \"../data/\" + event[\"fn_H1\"]\nfn_L1 = \"../data/\" + event[\"fn_L1\"]\nfn_template = \"../data/\" + event[\"fn_template\"]\n\n# Read in data from H1 and L1, if available\ntry:\n    strain_H1, time_H1, chan_dict_H1 = rl.loaddata(fn_H1, \"H1\")\n    strain_L1, time_L1, chan_dict_L1 = rl.loaddata(fn_L1, \"L1\")\nexcept:\n    print(\"Cannot find data files!\")\n    print(\"You can download them from https://www.gwosc.org/s/events/\" + eventname)\n    print(\"Quitting.\")\n    quit()\n\n# Print info to confirm successful load\nprint(\"time_H1:\", len(time_H1), time_H1.min(), time_H1.max())\nprint(\"strain_H1:\", len(strain_H1), strain_H1.min(), strain_H1.max())\nprint(\"strain_L1:\", len(strain_L1), strain_L1.min(), strain_L1.max())\n","key":"GmblE1EmVx"},{"type":"output","id":"t5oA6OAFze6lk92U5qjby","data":[{"name":"stdout","output_type":"stream","text":"time_H1: 131072 1126259446.0 1126259477.9997559\nstrain_H1: 131072 -7.044665943156067e-19 7.706262192397465e-19\nstrain_L1: 131072 -1.8697138664279764e-18 -4.60035111311666e-20\n"}],"key":"x8aD7D8Ahq"}],"key":"yXazsIfkUj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Gaps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vz7GWYquPv"}],"identifier":"data-gaps","label":"Data Gaps","html_id":"data-gaps","implicit":true,"key":"YmqFsxjtGF"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"NOTE","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VWuXAj1Nrn"}],"key":"V83Z5LkhZQ"},{"type":"text","value":" that in general, LIGO strain time series data has gaps (filled with NaNs) when the detectors are not taking valid (“science quality”) data. Analyzing these data requires the user to\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sQdYoN1Cru"},{"type":"link","url":"https://www.gwosc.org/timeline/","children":[{"type":"text","value":"loop over “segments”","key":"MKzk6MxXc2"}],"urlSource":"https://www.gwosc.org/timeline/","key":"sbPVpSDmAI"},{"type":"text","value":" of valid data stretches.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pZypRmnEwF"}],"key":"YFiDxutFdZ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this tutorial, for simplicity, we assume there are no data gaps - this will not work for all times!","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oRRiNNK2wx"}],"key":"B1fEwPebRA"},{"type":"text","value":"  See the\n","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wlXOm9Lt5T"},{"type":"link","url":"https://www.gwosc.org/timeline/","children":[{"type":"text","value":"notes on segments","key":"Ja3mnAmpKJ"}],"urlSource":"https://www.gwosc.org/timeline/","key":"aRsVVvkLmW"},{"type":"text","value":" for details.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bqhjUkBd7c"}],"key":"pzUkRzwEc1"}],"key":"RhysNTokIY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First look at the data from H1 and L1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MiUSGGD9BQ"}],"identifier":"first-look-at-the-data-from-h1-and-l1","label":"First look at the data from H1 and L1","html_id":"first-look-at-the-data-from-h1-and-l1","implicit":true,"key":"GTpWSMlVTS"}],"key":"HmeKKP0IDz"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false},"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"# both H1 and L1 will have the same time vector, so:\ntime = time_H1\n# the time sample interval (uniformly sampled!)\ndt = time[1] - time[0]\n\n# Let's look at the data and print out some stuff:\n\nprint('time_H1: len, min, mean, max = ', \\\n    len(time_H1), time_H1.min(), time_H1.mean(), time_H1.max() )\nprint('strain_H1: len, min, mean, max = ', \\\n    len(strain_H1), strain_H1.min(),strain_H1.mean(),strain_H1.max())\nprint( 'strain_L1: len, min, mean, max = ', \\\n    len(strain_L1), strain_L1.min(),strain_L1.mean(),strain_L1.max())\n\n#What's in chan_dict?  (See also https://www.gwosc.org/tutorials/)\nbits = chan_dict_H1['DATA']\nprint(\"For H1, {0} out of {1} seconds contain usable DATA\".format(bits.sum(), len(bits)))\nbits = chan_dict_L1['DATA']\nprint(\"For L1, {0} out of {1} seconds contain usable DATA\".format(bits.sum(), len(bits)))\n ","key":"k0uQeYC4VQ"},{"type":"output","id":"B6BppD-zLQO2BDwp_yNRx","data":[{"name":"stdout","output_type":"stream","text":"time_H1: len, min, mean, max =  131072 1126259446.0 1126259461.999878 1126259477.9997559\nstrain_H1: len, min, mean, max =  131072 -7.044665943156067e-19 5.895522509246437e-23 7.706262192397465e-19\nstrain_L1: len, min, mean, max =  131072 -1.8697138664279764e-18 -1.0522332249909908e-18 -4.60035111311666e-20\nFor H1, 32 out of 32 seconds contain usable DATA\nFor L1, 32 out of 32 seconds contain usable DATA\n"}],"key":"hR3NgIaEv2"}],"key":"kOPH18miai"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# plot +- deltat seconds around the event:\n# index into the strain time series for this time interval:\ndeltat = 5\nindxt = np.where((time \u003e= tevent-deltat) \u0026 (time \u003c tevent+deltat))\nprint(tevent)\n\nif make_plots:\n    plt.figure()\n    plt.plot(time[indxt]-tevent,strain_H1[indxt],'r',label='H1 strain')\n    plt.plot(time[indxt]-tevent,strain_L1[indxt],'g',label='L1 strain')\n    plt.xlabel('time (s) since '+str(tevent))\n    plt.ylabel('strain')\n    plt.legend(loc='lower right')\n    plt.title('Advanced LIGO strain data near '+eventname)\n    plt.savefig(FIGDIR / f\"{eventname}_strain.{plottype}\", dpi=150, bbox_inches=\"tight\")\n","key":"dVXQLR4h0F"},{"type":"output","id":"stM3a2PZ-PZWz_HGoMkq7","data":[{"name":"stdout","output_type":"stream","text":"1126259462.44\n"},{"output_type":"display_data","metadata":{"image/png":{"height":454,"width":578}},"data":{"image/png":{"content_type":"image/png","hash":"0e81b6cabe76b3cbb710c480dca5d580","path":"/build/0e81b6cabe76b3cbb710c480dca5d580.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"N0ykm8IOr1"}],"key":"ZBq1KBD87t"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The data are dominated by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dZmX7FCdip"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"low frequency noise","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JwW5TGWq8L"}],"key":"c4JYKFRgNQ"},{"type":"text","value":"; there is no way to see a signal here, without some signal processing.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"trQVvFcxJa"}],"key":"LfmkGAhdvp"}],"key":"LjJnGmFz9V"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Amplitude Spectral Density (ASD)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KZsGrModjD"}],"identifier":"plot-the-amplitude-spectral-density-asd","label":"Plot the Amplitude Spectral Density (ASD)","html_id":"plot-the-amplitude-spectral-density-asd","implicit":true,"key":"u5jHj0hRkY"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Plotting these data in the Fourier domain gives us an idea of the frequency content of the data. A way to visualize the frequency content of the data is to plot the amplitude spectral density, ASD.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jx5CrlaF8b"}],"key":"eVTSJhK0at"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ASDs are the square root of the power spectral densities (PSDs), which are averages of the square of the fast fourier transforms (FFTs) of the data.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LATIHs33s2"}],"key":"RSeabCz2UL"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"They are an estimate of the “strain-equivalent noise” of the detectors versus frequency,\nwhich limit the ability of the detectors to identify GW signals.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ReLlCZ3wpj"}],"key":"rBNL9UKop5"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"They are in units of strain/rt(Hz).\nSo, if you want to know the root-mean-square (rms) strain noise in a frequency band,\nintegrate (sum) the squares of the ASD over that band, then take the square-root.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"YbmJ3BJiJc"}],"key":"ezXpiunC2k"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"There’s a signal in these data!\nFor the moment, let’s ignore that, and assume it’s all noise.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"eCqzfW9nVx"}],"key":"QLUWsC57ZI"}],"key":"Y9JkGCnb8r"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"make_psds = 1\nif make_psds:\n    # number of sample for the fast fourier transform:\n    NFFT = 4*fs\n    Pxx_H1, freqs = mlab.psd(strain_H1, Fs = fs, NFFT = NFFT)\n    Pxx_L1, freqs = mlab.psd(strain_L1, Fs = fs, NFFT = NFFT)\n\n    # We will use interpolations of the ASDs computed above for whitening:\n    psd_H1 = interp1d(freqs, Pxx_H1)\n    psd_L1 = interp1d(freqs, Pxx_L1)\n\n    # Here is an approximate, smoothed PSD for H1 during O1, with no lines. We'll use it later.    \n    Pxx = (1.e-22*(18./(0.1+freqs))**2)**2+0.7e-23**2+((freqs/2000.)*4.e-23)**2\n    psd_smooth = interp1d(freqs, Pxx)\n\nif make_plots:\n    # plot the ASDs, with the template overlaid:\n    f_min = 20.\n    f_max = 2000. \n    plt.figure(figsize=(10,8))\n    plt.loglog(freqs, np.sqrt(Pxx_L1),'g',label='L1 strain')\n    plt.loglog(freqs, np.sqrt(Pxx_H1),'r',label='H1 strain')\n    plt.loglog(freqs, np.sqrt(Pxx),'k',label='H1 strain, O1 smooth model')\n    plt.axis([f_min, f_max, 1e-24, 1e-19])\n    plt.grid('on')\n    plt.ylabel('ASD (strain/rtHz)')\n    plt.xlabel('Freq (Hz)')\n    plt.legend(loc='upper center')\n    plt.title('Advanced LIGO strain data near '+eventname)\n    plt.savefig(FIGDIR / f\"{eventname}_ASDs.{plottype}\")\n","key":"JAXzPCcSNk"},{"type":"output","id":"BaJgxXVjUqVmSY8uHLrY3","data":[{"output_type":"display_data","metadata":{"image/png":{"height":701,"width":863}},"data":{"image/png":{"content_type":"image/png","hash":"ea11a0f0ad08a3f3aebd565ec297783e","path":"/build/ea11a0f0ad08a3f3aebd565ec297783e.png"},"text/plain":{"content":"\u003cFigure size 1000x800 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"oFstVRl1Qt"}],"key":"ULPIxnwMpT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"NOTE that we only plot the data between f_min = 20 Hz and f_max = 2000 Hz.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bCOguwIoeB"}],"key":"dh6hHMDLT9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Below f_min, the data ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tUnFrSnEkF"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"are not properly calibrated","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I6YkAiuxQZ"}],"key":"z8arNzfWy2"},{"type":"text","value":". That’s OK, because the noise is so high below f_min that LIGO cannot sense gravitational wave strain from astrophysical sources in that band.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kp35jmyw5a"}],"key":"u5jNN57NPl"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The sample rate is fs = 4096 Hz (2^12 Hz), so the data cannot capture frequency content above the Nyquist frequency = fs/2 = 2048 Hz. That’s OK, because our events only have detectable frequency content in the range given by fband, defined above; the upper end will (almost) always be below the Nyquist frequency. We set f_max = 2000, a bit below Nyquist.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U4Q5xycjXz"}],"key":"ewxGoDr4HZ"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"You can see strong spectral lines in the data; they are all of instrumental origin. Some are engineered into the detectors (mirror suspension resonances at ~500 Hz and harmonics, calibration lines, control dither lines, etc) and some (60 Hz and harmonics) are unwanted. We’ll return to these, later.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"k4jlJmUewC"}],"key":"m4khMPuchI"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"You can’t see the signal in this plot, since it is relatively weak and less than a second long, while this plot averages over 32 seconds of data. So this plot is entirely dominated by instrumental noise.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"F4M1GgDZGD"}],"key":"QE5yUf6hae"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The smooth model is hard-coded and tuned by eye; it won’t be right for arbitrary times. We will only use it below for things that don’t require much accuracy.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"BPcoTv9y7Q"}],"key":"sLxF26IwMM"}],"key":"cOyrqZINJ4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Binary Neutron Star (BNS) detection range","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qGtad7QybS"}],"identifier":"binary-neutron-star-bns-detection-range","label":"Binary Neutron Star (BNS) detection range","html_id":"binary-neutron-star-bns-detection-range","implicit":true,"key":"LPBCUwgxDh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A standard metric that LIGO uses to evaluate the sensitivity of our detectors, based on the detector noise ASD, is the BNS range.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LJU17OSYSf"}],"key":"wtlsn2uq2A"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This is defined as the distance to which a LIGO detector can register a BNS signal with a single detector signal-to-noise ratio (SNR) of 8, averaged over source direction and orientation.  Here, SNR 8 is used as a nominal detection threshold, similar to typical CBC detection thresholds of SNR 6-8.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"siR8TwWX1Y"}],"key":"UrSlXlCOfl"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We take each neutron star in the BNS system to have a mass of 1.4 times the mass of the sun, and negligible spin.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CAbVTCO5mx"}],"key":"XUNHiXfuBq"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"GWs from BNS mergers are like “standard sirens”; we know their amplitude at the source from theoretical calculations. The amplitude falls off like 1/r, so their amplitude at the detectors on Earth tells us how far away they are. This is great, because it is hard, in general, to know the distance to astronomical sources.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"i86GKAT12s"}],"key":"lnVrkE9dg5"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The amplitude at the source is computed in the post-Newtonian “quadrupole approximation”. This is valid for the inspiral phase only, and is approximate at best; there is no simple expression for the post-inspiral (merger and ringdown) phase. So this won’t work for high-mass binary black holes like GW150914, which have a lot of signal strength in the post-inspiral phase.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CmPaXktO6i"}],"key":"rdrqZuiaTp"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"But, in order to use them as standard sirens, we need to know the source direction and orientation relative to the detector and its “quadrupole antenna pattern” response to such signals. It is a standard (if non-trivial) computation to average over all source directions and orientations; the average amplitude is 1./2.2648 times the maximum value.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"f7AJGhCizM"}],"key":"EFFgnit3u4"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"This calculation is described in Appendix D of:\nFINDCHIRP: An algorithm for detection of gravitational waves from inspiraling compact binaries\nB. Allen et al., PHYSICAL REVIEW D 85, 122006 (2012) ; ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TWgSVkjSe4"},{"type":"link","url":"http://arxiv.org/abs/gr-qc/0509116","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"http://​arxiv​.org​/abs​/gr​-qc​/0509116","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"GfmgoP8X0n"}],"urlSource":"http://arxiv.org/abs/gr-qc/0509116","key":"ZHreS5S9mm"}],"key":"X70qRySGal"}],"key":"OyHxNfgxoW"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"BNS_range = 1\nif BNS_range:\n    #-- compute the binary neutron star (BNS) detectability range\n\n    #-- choose a detector noise power spectrum:\n    f = freqs.copy()\n    # get frequency step size\n    df = f[2]-f[1]\n\n    #-- constants\n    # speed of light:\n    clight = 2.99792458e8                # m/s\n    # Newton's gravitational constant\n    G = 6.67259e-11                      # m^3/kg/s^2 \n    # one parsec, popular unit of astronomical distance (around 3.26 light years)\n    parsec = 3.08568025e16               # m\n    # solar mass\n    MSol = 1.989e30                      # kg\n    # solar mass in seconds (isn't relativity fun?):\n    tSol = MSol*G/np.power(clight,3)     # s\n    # Single-detector SNR for detection above noise background: \n    SNRdet = 8.\n    # conversion from maximum range (horizon) to average range:\n    Favg = 2.2648\n    # mass of a typical neutron star, in solar masses:\n    mNS = 1.4\n\n    # Masses in solar masses\n    m1 = m2 = mNS    \n    mtot = m1+m2  # the total mass\n    eta = (m1*m2)/mtot**2  # the symmetric mass ratio\n    mchirp = mtot*eta**(3./5.)  # the chirp mass (FINDCHIRP, following Eqn 3.1b)\n\n    # distance to a fiducial BNS source:\n    dist = 1.0                           # in Mpc\n    Dist =  dist * 1.0e6 * parsec /clight # from Mpc to seconds\n\n    # We integrate the signal up to the frequency of the \"Innermost stable circular orbit (ISCO)\" \n    R_isco = 6.      # Orbital separation at ISCO, in geometric units. 6M for PN ISCO; 2.8M for EOB \n    # frequency at ISCO (end the chirp here; the merger and ringdown follow) \n    f_isco = 1./(np.power(R_isco,1.5)*np.pi*tSol*mtot)\n    # minimum frequency (below which, detector noise is too high to register any signal):\n    f_min = 20. # Hz\n    # select the range of frequencies between f_min and fisco\n    fr = np.nonzero(np.logical_and(f \u003e f_min , f \u003c f_isco))\n    # get the frequency and spectrum in that range:\n    ffr = f[fr]\n\n    # In stationary phase approx, this is htilde(f):  \n    # See FINDCHIRP Eqns 3.4, or 8.4-8.5 \n    htilde = (2.*tSol/Dist)*np.power(mchirp,5./6.)*np.sqrt(5./96./np.pi)*(np.pi*tSol)\n    htilde *= np.power(np.pi*tSol*ffr,-7./6.)\n    htilda2 = htilde**2\n\n    # loop over the detectors\n    dets = ['H1', 'L1']\n    for det in dets:\n        if det == 'L1': sspec = Pxx_L1.copy()\n        else:           sspec = Pxx_H1.copy()\n        sspecfr = sspec[fr]\n        # compute \"inspiral horizon distance\" for optimally oriented binary; FINDCHIRP Eqn D2:\n        D_BNS = np.sqrt(4.*np.sum(htilda2/sspecfr)*df)/SNRdet\n        # and the \"inspiral range\", averaged over source direction and orientation:\n        R_BNS = D_BNS/Favg\n        print(det+' BNS inspiral horizon = {0:.1f} Mpc, BNS inspiral range   = {1:.1f} Mpc'.format(D_BNS,R_BNS))","key":"bgWgAb9ZQ3"},{"type":"output","id":"AbdZ1jHp1cfbatF5EUqVQ","data":[{"name":"stdout","output_type":"stream","text":"H1 BNS inspiral horizon = 169.4 Mpc, BNS inspiral range   = 74.8 Mpc\nL1 BNS inspiral horizon = 147.1 Mpc, BNS inspiral range   = 64.9 Mpc\n"}],"key":"CDQRooFhTH"}],"key":"R5HGiqPNSu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"BBH range is \u003e\u003e BNS range!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vSu4N4EKRM"}],"identifier":"bbh-range-is-bns-range","label":"BBH range is \u003e\u003e BNS range!","html_id":"bbh-range-is-bns-range","implicit":true,"key":"cAinPXhXTm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"NOTE that, since mass is the source of gravity and thus also of gravitational waves, systems with higher masses (such as the binary black hole merger GW150914) are much “louder” and can be detected to much higher distances than the BNS range. We’ll compute the BBH range, using a template with specific masses, below.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uVcJyIKsWV"}],"key":"TVKFyPKlgP"}],"key":"ehc5Rb90yN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Whitening","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oXAEKqsLXU"}],"identifier":"whitening","label":"Whitening","html_id":"whitening","implicit":true,"key":"CtFflyfJ5K"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"From the ASD above, we can see that the data are very strongly “colored” - noise fluctuations are much larger at low and high frequencies and near spectral lines, reaching a roughly flat (“white”) minimum in the band around 80 to 300 Hz.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vxJREECJPM"}],"key":"NclZ1z8neF"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We can “whiten” the data (dividing it by the noise amplitude spectrum, in the fourier domain), suppressing the extra noise at low frequencies and at the spectral lines, to better see the weak signals in the most sensitive band.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DYGWNaR5pv"}],"key":"MLmsrzFmwa"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Whitening is always one of the first steps in astrophysical data analysis (searches, parameter estimation).\nWhitening requires no prior knowledge of spectral lines, etc; only the data are needed.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ITSUFx8GIk"}],"key":"ImbPnRq0Lj"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"To get rid of remaining high frequency noise, we will also bandpass the data.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wgMy5js0tp"}],"key":"aAtJAvkQim"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The resulting time series is no longer in units of strain; now in units of “sigmas” away from the mean.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fHMc5AGyy2"}],"key":"bLMMseFzyC"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"We will plot the whitened strain data, along with the signal template, after the matched filtering section, below.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"gdXb6r1nEZ"}],"key":"ZgGovaUjgs"}],"key":"WSK6uUxROF"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# function to whiten data\ndef whiten(strain, interp_psd, dt):\n    Nt = len(strain)\n    freqs = np.fft.rfftfreq(Nt, dt)\n    freqs1 = np.linspace(0, 2048, Nt // 2 + 1)\n\n    # whitening: transform to freq domain, divide by asd, then transform back, \n    # taking care to get normalization right.\n    hf = np.fft.rfft(strain)\n    norm = 1./np.sqrt(1./(dt*2))\n    white_hf = hf / np.sqrt(interp_psd(freqs)) * norm\n    white_ht = np.fft.irfft(white_hf, n=Nt)\n    return white_ht\n\nwhiten_data = 1\nif whiten_data:\n    # now whiten the data from H1 and L1, and the template (use H1 PSD):\n    strain_H1_whiten = whiten(strain_H1,psd_H1,dt)\n    strain_L1_whiten = whiten(strain_L1,psd_L1,dt)\n    \n    # We need to suppress the high frequency noise (no signal!) with some bandpassing:\n    bb, ab = butter(4, [fband[0]*2./fs, fband[1]*2./fs], btype='band')\n    normalization = np.sqrt((fband[1]-fband[0])/(fs/2))\n    strain_H1_whitenbp = filtfilt(bb, ab, strain_H1_whiten) / normalization\n    strain_L1_whitenbp = filtfilt(bb, ab, strain_L1_whiten) / normalization","key":"A5HhkeV3Jc"},{"type":"output","id":"CnKQ20hMhSs4buPHbMpUo","data":[],"key":"o7nbfP4sph"}],"key":"UHYhHLj4d6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spectrograms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B0SPl6z0BX"}],"identifier":"spectrograms","label":"Spectrograms","html_id":"spectrograms","implicit":true,"key":"J9LWGqxPY3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now let’s plot a short time-frequency spectrogram around our event:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Fy81fqcdmY"}],"key":"x1hYFsmb0t"}],"key":"wZo5EqNNRd"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"if make_plots:\n    # index into the strain time series for this time interval:\n    indxt = np.where((time \u003e= tevent-deltat) \u0026 (time \u003c tevent+deltat))\n\n    # pick a shorter FTT time interval, like 1/8 of a second:\n    NFFT = int(fs/8)\n    # and with a lot of overlap, to resolve short-time features:\n    NOVL = int(NFFT*15./16)\n    # and choose a window that minimizes \"spectral leakage\" \n    # (https://en.wikipedia.org/wiki/Spectral_leakage)\n    window = np.blackman(NFFT)\n\n    # the right colormap is all-important! See:\n    # http://matplotlib.org/examples/color/colormaps_reference.html\n    # viridis seems to be the best for our purposes, but it's new; if you don't have it, you can settle for ocean.\n    #spec_cmap='viridis'\n    spec_cmap='ocean'\n\n    # Plot the H1 spectrogram:\n    plt.figure(figsize=(10,6))\n    spec_H1, freqs, bins, im = plt.specgram(strain_H1[indxt], NFFT=NFFT, Fs=fs, window=window, \n                                            noverlap=NOVL, cmap=spec_cmap, xextent=[-deltat,deltat])\n    plt.xlabel('time (s) since '+str(tevent))\n    plt.ylabel('Frequency (Hz)')\n    plt.colorbar()\n    plt.axis([-deltat, deltat, 0, 2000])\n    plt.title('aLIGO H1 strain data near '+eventname)\n    plt.savefig(FIGDIR / f\"{eventname}_H1_spectrogram.{plottype}\")\n\n    # Plot the L1 spectrogram:\n    plt.figure(figsize=(10,6))\n    spec_H1, freqs, bins, im = plt.specgram(strain_L1[indxt], NFFT=NFFT, Fs=fs, window=window, \n                                            noverlap=NOVL, cmap=spec_cmap, xextent=[-deltat,deltat])\n    plt.xlabel('time (s) since '+str(tevent))\n    plt.ylabel('Frequency (Hz)')\n    plt.colorbar()\n    plt.axis([-deltat, deltat, 0, 2000])\n    plt.title('aLIGO L1 strain data near '+eventname)\n    plt.savefig(FIGDIR / f\"{eventname}_L1_spectrogram.{plottype}\")\n\n","key":"Q0pn4LMVbS"},{"type":"output","id":"Ga7AwExpz-O633lVS2p4P","data":[{"output_type":"display_data","metadata":{"image/png":{"height":546,"width":814}},"data":{"image/png":{"content_type":"image/png","hash":"f1b78858bd0b967c8a55fedc99c90cf2","path":"/build/f1b78858bd0b967c8a55fedc99c90cf2.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{"image/png":{"height":546,"width":814}},"data":{"image/png":{"content_type":"image/png","hash":"e535a0c0c91b9e670e597b10b8e2c0c2","path":"/build/e535a0c0c91b9e670e597b10b8e2c0c2.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"xPjqnLFj9K"}],"key":"fhgVhQnnC9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the above spectrograms, you may see lots of excess power below ~20 Hz, as well as strong spectral lines at 500, 1000, 1500 Hz (also evident in the ASDs above). The lines at multiples of 500 Hz are the harmonics of the “violin modes” of the fibers holding up the mirrors of the Advanced LIGO interferometers.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HWDQFPxP0v"}],"key":"HI0tQb5bvd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now let’s zoom in on where we think the signal is, using the whitened data, in the hope of seeing a chirp:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"stqnCXNiHI"}],"key":"JhIkYFdQzX"}],"key":"Zi5ZNptJ4M"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"if make_plots:\n    #  plot the whitened data, zooming in on the signal region:\n\n    # pick a shorter FTT time interval, like 1/16 of a second:\n    NFFT = int(fs/16.0)\n    # and with a lot of overlap, to resolve short-time features:\n    NOVL = int(NFFT*15/16.0)\n    # choose a window that minimizes \"spectral leakage\" \n    # (https://en.wikipedia.org/wiki/Spectral_leakage)\n    window = np.blackman(NFFT)\n\n    # Plot the H1 whitened spectrogram around the signal\n    plt.figure(figsize=(10,6))\n    spec_H1, freqs, bins, im = plt.specgram(strain_H1_whiten[indxt], NFFT=NFFT, Fs=fs, window=window, \n                                            noverlap=NOVL, cmap=spec_cmap, xextent=[-deltat,deltat])\n    plt.xlabel('time (s) since '+str(tevent))\n    plt.ylabel('Frequency (Hz)')\n    plt.colorbar()\n    plt.axis([-0.5, 0.5, 0, 500])\n    plt.title('aLIGO H1 strain data near '+eventname)\n    plt.savefig(FIGDIR / f\"{eventname}_H1_spectrogram_whitened.{plottype}\")\n\n    # Plot the L1 whitened spectrogram around the signal\n    plt.figure(figsize=(10,6))\n    spec_H1, freqs, bins, im = plt.specgram(strain_L1_whiten[indxt], NFFT=NFFT, Fs=fs, window=window, \n                                            noverlap=NOVL, cmap=spec_cmap, xextent=[-deltat,deltat])\n    plt.xlabel('time (s) since '+str(tevent))\n    plt.ylabel('Frequency (Hz)')\n    plt.colorbar()\n    plt.axis([-0.5, 0.5, 0, 500])\n    plt.title('aLIGO L1 strain data near '+eventname)\n    plt.savefig(FIGDIR / f\"{eventname}_L1_spectrogram_whitened.{plottype}\")\n","key":"tSIdaKY5Ys"},{"type":"output","id":"qYL6Bwr2COO3W2h9_sYD-","data":[{"output_type":"display_data","metadata":{"image/png":{"height":546,"width":805}},"data":{"image/png":{"content_type":"image/png","hash":"cf74e252479e6610703430205c6de9d2","path":"/build/cf74e252479e6610703430205c6de9d2.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{"image/png":{"height":546,"width":805}},"data":{"image/png":{"content_type":"image/png","hash":"6a563d45be0a37bf1a84cf7c5b6c0284","path":"/build/6a563d45be0a37bf1a84cf7c5b6c0284.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"rselydlxr7"}],"key":"Ruh4LVjgv6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Loud (high SNR) signals may be visible in these spectrograms.  Compact object mergers show a characteristic “chirp” as the signal rises in frequency.  If you can’t see anything, try\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W2GU2wsFNL"},{"type":"link","url":"https://www.gwosc.org/events/GW150914/","children":[{"type":"text","value":"event GW150914","key":"xhFUSCbBwA"}],"urlSource":"https://www.gwosc.org/events/GW150914/","key":"ic2slhD0Tf"},{"type":"text","value":", by changing the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pc7jfM3lhO"},{"type":"inlineCode","value":"eventname","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"haXrjvCqZq"},{"type":"text","value":" variable in the first cell above.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Iko6vrh3KJ"}],"key":"LwR4YnAT4W"}],"key":"Z36KvjTai3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Waveform Template","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qLJSjk79tZ"}],"identifier":"waveform-template","label":"Waveform Template","html_id":"waveform-template","implicit":true,"key":"vDHDnC3XCe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The results of a full LIGO-Virgo analysis of this BBH event include a set of parameters that are consistent with a range of parameterized waveform templates. Here we pick one for use in matched filtering.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YqKo5q2PSZ"}],"key":"LniDvcHiAn"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"As noted above, the results won’t be identical to what is in the LIGO-Virgo papers, since we’re skipping many subtleties, such as combining many consistent templates.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nx5ra10Ba1"}],"key":"l6OVIsDwSu"}],"key":"EojjxplFgP"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# read in the template (plus and cross) and parameters for the theoretical waveform\ntry:\n    f_template = h5py.File(fn_template, \"r\")\nexcept:\n    print(\"Cannot find template file!\")\n    print(\"You can download it from https://www.gwosc.org/s/events/\"+eventname+'/'+fn_template)\n    print(\"Quitting.\")\n    quit()","key":"Zef6xtydqR"},{"type":"output","id":"vB3_ZesuEwCDajW1ogBDx","data":[],"key":"yUeg3L2HmZ"}],"key":"RoPrYa1bmA"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# extract metadata from the template file:\ntemplate_p, template_c = f_template[\"template\"][...]\nt_m1 = f_template[\"/meta\"].attrs['m1']\nt_m2 = f_template[\"/meta\"].attrs['m2']\nt_a1 = f_template[\"/meta\"].attrs['a1']\nt_a2 = f_template[\"/meta\"].attrs['a2']\nt_approx = f_template[\"/meta\"].attrs['approx']\nf_template.close()\n# the template extends to roughly 16s, zero-padded to the 32s data length. The merger will be roughly 16s in.\ntemplate_offset = 16.\n\n# whiten the templates:\ntemplate_p_whiten = whiten(template_p,psd_H1,dt)\ntemplate_c_whiten = whiten(template_c,psd_H1,dt)\ntemplate_p_whitenbp = filtfilt(bb, ab, template_p_whiten) / normalization\ntemplate_c_whitenbp = filtfilt(bb, ab, template_c_whiten) / normalization\n\n# Compute, print and plot some properties of the template:\n\n# constants:\nclight = 2.99792458e8                # m/s\nG = 6.67259e-11                      # m^3/kg/s^2 \nMSol = 1.989e30                      # kg\n\n# template parameters: masses in units of MSol:\nt_mtot = t_m1+t_m2\n# final BH mass is typically 95% of the total initial mass:\nt_mfin = t_mtot*0.95\n# Final BH radius, in km:\nR_fin = 2*G*t_mfin*MSol/clight**2/1000.\n\n# complex template:\ntemplate = (template_p + template_c*1.j) \nttime = time-time[0]-template_offset\n\n# compute the instantaneous frequency of this chirp-like signal:\ntphase = np.unwrap(np.angle(template))\nfGW = np.gradient(tphase)*fs/(2.*np.pi)\n# fix discontinuities at the very end:\n# iffix = np.where(np.abs(np.gradient(fGW)) \u003e 100.)[0]\niffix = np.where(np.abs(template) \u003c np.abs(template).max()*0.001)[0]\nfGW[iffix] = fGW[iffix[0]-1]\nfGW[np.where(fGW \u003c 1.)] = fGW[iffix[0]-1]\n\n# compute v/c:\nvoverc = (G*t_mtot*MSol*np.pi*fGW/clight**3)**(1./3.)\n\n# index where f_GW is in-band:\nf_inband = fband[0]\niband = np.where(fGW \u003e f_inband)[0][0]\n# index at the peak of the waveform:\nipeak = np.argmax(np.abs(template))\n\n# number of cycles between inband and peak:\nNcycles = (tphase[ipeak]-tphase[iband])/(2.*np.pi)\n\nprint('Properties of waveform template in {0}'.format(fn_template))\nprint(\"Waveform family = {0}\".format(t_approx))\nprint(\"Masses = {0:.2f}, {1:.2f} Msun\".format(t_m1,t_m2))\nprint('Mtot = {0:.2f} Msun, mfinal = {1:.2f} Msun '.format(t_mtot,t_mfin))\nprint(\"Spins = {0:.2f}, {1:.2f}\".format(t_a1,t_a2))\nprint('Freq at inband, peak = {0:.2f}, {1:.2f} Hz'.format(fGW[iband],fGW[ipeak]))\nprint('Time at inband, peak = {0:.2f}, {1:.2f} s'.format(ttime[iband],ttime[ipeak]))\nprint('Duration (s) inband-peak = {0:.2f} s'.format(ttime[ipeak]-ttime[iband]))\nprint('N_cycles inband-peak = {0:.0f}'.format(Ncycles))\nprint('v/c at peak = {0:.2f}'.format(voverc[ipeak]))\nprint('Radius of final BH = {0:.0f} km'.format(R_fin))\n\nif make_plots:\n    plt.figure(figsize=(10,16))\n    plt.subplot(4,1,1)\n    plt.plot(ttime,template_p)\n    plt.xlim([-template_offset,1.])\n    plt.grid()\n    plt.xlabel('time (s)')\n    plt.ylabel('strain')\n    plt.title(eventname+' template at D_eff = 1 Mpc')\n    \n    plt.subplot(4,1,2)\n    plt.plot(ttime,template_p)\n    plt.xlim([-1.1,0.1])\n    plt.grid()\n    plt.xlabel('time (s)')\n    plt.ylabel('strain')\n    #plt.title(eventname+' template at D_eff = 1 Mpc')\n    \n    plt.subplot(4,1,3)\n    plt.plot(ttime,fGW)\n    plt.xlim([-1.1,0.1])\n    plt.grid()\n    plt.xlabel('time (s)')\n    plt.ylabel('f_GW')\n    #plt.title(eventname+' template f_GW')\n    \n    plt.subplot(4,1,4)\n    plt.plot(ttime,voverc)\n    plt.xlim([-1.1,0.1])\n    plt.grid()\n    plt.xlabel('time (s)')\n    plt.ylabel('v/c')\n    #plt.title(eventname+' template v/c')\n    plt.savefig(FIGDIR / f\"{eventname}_template.{plottype}\")\n","key":"g8R0iGnk5z"},{"type":"output","id":"IuxfeY96Y6FUFv7JeRbSE","data":[{"name":"stdout","output_type":"stream","text":"Properties of waveform template in ../data/GW150914_4_template.hdf5\nWaveform family = lalsim.SEOBNRv2\nMasses = 41.74, 29.24 Msun\nMtot = 70.98 Msun, mfinal = 67.43 Msun \nSpins = 0.35, -0.77\nFreq at inband, peak = 43.05, 169.84 Hz\nTime at inband, peak = -0.08, -0.02 s\nDuration (s) inband-peak = 0.06 s\nN_cycles inband-peak = 4\nv/c at peak = 0.57\nRadius of final BH = 199 km\n"},{"output_type":"display_data","metadata":{"image/png":{"height":1316,"width":851}},"data":{"image/png":{"content_type":"image/png","hash":"dfe015ee1f617827cd17e7ac387f6ef0","path":"/build/dfe015ee1f617827cd17e7ac387f6ef0.png"},"text/plain":{"content":"\u003cFigure size 1000x1600 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"TobrKaJhPv"}],"key":"lAbBvOFbGN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Matched filtering to find the signal","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wzsc7PwPo1"}],"identifier":"matched-filtering-to-find-the-signal","label":"Matched filtering to find the signal","html_id":"matched-filtering-to-find-the-signal","implicit":true,"key":"DDI4Ym6odu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Matched filtering is the optimal way to find a known signal buried in stationary, Gaussian noise. It is the standard technique used by the gravitational wave community to find GW signals from compact binary mergers in noisy detector data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hTxI7s8aRE"}],"key":"Xyqv04hz2k"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For some loud signals, it may be possible to see the signal in the whitened data or spectrograms. On the other hand, low signal-to-noise ratio (SNR) signals or signals which are of long duration in time may not be visible, even in the whitened data.  LIGO scientists use matched filtering to find such “hidden” signals. A matched filter works by compressing the entire signal into one time bin (by convention, the “end time” of the waveform).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"N3Pv2GOm7t"}],"key":"uRZS5d3OxW"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"LIGO uses a rather elaborate software suite to match the data against a family of such signal waveforms (“templates”), to find the best match. This procedure helps to “optimally” separate signals from instrumental noise, and to infer the parameters of the source (masses, spins, sky location, orbit orientation, etc) from the best match templates.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ootYZ1nrFA"}],"key":"Q768TZqCsN"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"A blind search requires us to search over many compact binary merger templates (eg, 250,000) with different masses and spins, as well as over all times in all detectors, and then requiring triggers coincident in time and template between detectors. It’s an extremely complex and computationally-intensive “search pipeline”.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"NGait5En0s"}],"key":"Hyv04GcofS"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Here, we simplify things, using only one template (the one identified in the full search as being a good match to the data).","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OtIhNpIWEd"}],"key":"ID1Bv3WBmu"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Assuming that the data around this event is fairly Gaussian and stationary, we’ll use this simple method to identify the signal (matching the template) in our 32 second stretch of data. The peak in the SNR vs time is a “single-detector event trigger”.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yT7vc5PChb"}],"key":"GedP5csGTs"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"This calculation is described in section IV of:\nFINDCHIRP: An algorithm for detection of gravitational waves from inspiraling compact binaries\nB. Allen et al., PHYSICAL REVIEW D 85, 122006 (2012) ; ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ct5hXzfk7l"},{"type":"link","url":"http://arxiv.org/abs/gr-qc/0509116","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"http://​arxiv​.org​/abs​/gr​-qc​/0509116","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Skr8252Nha"}],"urlSource":"http://arxiv.org/abs/gr-qc/0509116","key":"UWq3SAtCcc"}],"key":"ZjJq98xBIb"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"The full search procedure is described in\nGW150914: First results from the search for binary black hole coalescence with Advanced LIGO,\nThe LIGO Scientific Collaboration, the Virgo Collaboration, ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"H3edGj1aSr"},{"type":"link","url":"http://arxiv.org/abs/1602.03839","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"http://​arxiv​.org​/abs​/1602​.03839","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"QvUsym4D8j"}],"urlSource":"http://arxiv.org/abs/1602.03839","key":"utRlWKwgNN"}],"key":"USdAEO56eE"}],"key":"ImAQ2P3N3w"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# -- To calculate the PSD of the data, choose an overlap and a window (common to all detectors)\n#   that minimizes \"spectral leakage\" https://en.wikipedia.org/wiki/Spectral_leakage\nNFFT = 4*fs\npsd_window = np.blackman(NFFT)\n# and a 50% overlap:\nNOVL = NFFT//2\n\n# define the complex template, common to both detectors:\ntemplate = (template_p + template_c*1.j) \n# We will record the time where the data match the END of the template.\netime = time+template_offset\n# the length and sampling rate of the template MUST match that of the data.\ndatafreq = np.fft.fftfreq(template.size)*fs\ndf = np.abs(datafreq[1] - datafreq[0])\n\n# to remove effects at the beginning and end of the data stretch, window the data\n# https://en.wikipedia.org/wiki/Window_function#Tukey_window\ntry:   dwindow = windows.tukey(template.size, alpha=1./8)  # Tukey window preferred, but requires recent scipy version \nexcept: dwindow = windows.blackman(template.size)          # Blackman window OK if Tukey is not available\n\n# prepare the template fft.\ntemplate_fft = np.fft.fft(template*dwindow) / fs\n\n# loop over the detectors\ndets = ['H1', 'L1']\nfor det in dets:\n\n    if det == 'L1': data = strain_L1.copy()\n    else:           data = strain_H1.copy()\n\n    # -- Calculate the PSD of the data.  Also use an overlap, and window:\n    data_psd, freqs = mlab.psd(data, Fs = fs, NFFT = NFFT, window=psd_window, noverlap=NOVL)\n\n    # Take the Fourier Transform (FFT) of the data and the template (with dwindow)\n    data_fft = np.fft.fft(data*dwindow) / fs\n\n    # -- Interpolate to get the PSD values at the needed frequencies\n    power_vec = np.interp(np.abs(datafreq), freqs, data_psd)\n\n    # -- Calculate the matched filter output in the time domain:\n    # Multiply the Fourier Space template and data, and divide by the noise power in each frequency bin.\n    # Taking the Inverse Fourier Transform (IFFT) of the filter output puts it back in the time domain,\n    # so the result will be plotted as a function of time off-set between the template and the data:\n    optimal = data_fft * template_fft.conjugate() / power_vec\n    optimal_time = 2*np.fft.ifft(optimal)*fs\n\n    # -- Normalize the matched filter output:\n    # Normalize the matched filter output so that we expect a value of 1 at times of just noise.\n    # Then, the peak of the matched filter output will tell us the signal-to-noise ratio (SNR) of the signal.\n    sigmasq = 1*(template_fft * template_fft.conjugate() / power_vec).sum() * df\n    sigma = np.sqrt(np.abs(sigmasq))\n    SNR_complex = optimal_time/sigma\n\n    # shift the SNR vector by the template length so that the peak is at the END of the template\n    peaksample = int(data.size / 2)  # location of peak in the template\n    SNR_complex = np.roll(SNR_complex,peaksample)\n    SNR = abs(SNR_complex)\n\n    # find the time and SNR value at maximum:\n    indmax = np.argmax(SNR)\n    timemax = time[indmax]\n    SNRmax = SNR[indmax]\n\n    # Calculate the \"effective distance\" (see FINDCHIRP paper for definition)\n    # d_eff = (8. / SNRmax)*D_thresh\n    d_eff = sigma / SNRmax\n    # -- Calculate optimal horizon distnace\n    horizon = sigma/8\n\n    # Extract time offset and phase at peak\n    phase = np.angle(SNR_complex[indmax])\n    offset = (indmax-peaksample)\n\n    # apply time offset, phase, and d_eff to template \n    template_phaseshifted = np.real(template*np.exp(1j*phase))    # phase shift the template\n    template_rolled = np.roll(template_phaseshifted,offset) / d_eff  # Apply time offset and scale amplitude\n    \n    # Whiten and band-pass the template for plotting\n    template_whitened = whiten(template_rolled,interp1d(freqs, data_psd),dt)  # whiten the template\n    template_match = filtfilt(bb, ab, template_whitened) / normalization # Band-pass the template\n    \n    print('For detector {0}, maximum at {1:.4f} with SNR = {2:.1f}, D_eff = {3:.2f}, horizon = {4:0.1f} Mpc' \n          .format(det,timemax,SNRmax,d_eff,horizon))\n\n    if make_plots:\n\n        # plotting changes for the detectors:\n        if det == 'L1': \n            pcolor='g'\n            strain_whitenbp = strain_L1_whitenbp\n            template_L1 = template_match.copy()\n        else:\n            pcolor='r'\n            strain_whitenbp = strain_H1_whitenbp\n            template_H1 = template_match.copy()\n\n        # -- Plot the result\n        plt.figure(figsize=(10,8))\n        plt.subplot(2,1,1)\n        plt.plot(time-timemax, SNR, pcolor,label=det+' SNR(t)')\n        #plt.ylim([0,25.])\n        plt.grid('on')\n        plt.ylabel('SNR')\n        plt.xlabel('Time since {0:.4f}'.format(timemax))\n        plt.legend(loc='upper left')\n        plt.title(det+' matched filter SNR around event')\n\n        # zoom in\n        plt.subplot(2,1,2)\n        plt.plot(time-timemax, SNR, pcolor,label=det+' SNR(t)')\n        plt.grid('on')\n        plt.ylabel('SNR')\n        plt.xlim([-0.15,0.05])\n        #plt.xlim([-0.3,+0.3])\n        plt.grid('on')\n        plt.xlabel('Time since {0:.4f}'.format(timemax))\n        plt.legend(loc='upper left')\n        plt.savefig(FIGDIR / f\"{eventname}_H1_SNR.{plottype}\")\n\n        plt.figure(figsize=(10,8))\n        plt.subplot(2,1,1)\n        plt.plot(time-tevent,strain_whitenbp,pcolor,label=det+' whitened h(t)')\n        plt.plot(time-tevent,template_match,'k',label='Template(t)')\n        plt.ylim([-10,10])\n        plt.xlim([-0.15,0.05])\n        plt.grid('on')\n        plt.xlabel('Time since {0:.4f}'.format(timemax))\n        plt.ylabel('whitened strain (units of noise stdev)')\n        plt.legend(loc='upper left')\n        plt.title(det+' whitened data around event')\n\n        plt.subplot(2,1,2)\n        plt.plot(time-tevent,strain_whitenbp-template_match,pcolor,label=det+' resid')\n        plt.ylim([-10,10])\n        plt.xlim([-0.15,0.05])\n        plt.grid('on')\n        plt.xlabel('Time since {0:.4f}'.format(timemax))\n        plt.ylabel('whitened strain (units of noise stdev)')\n        plt.legend(loc='upper left')\n        plt.title(det+' Residual whitened data after subtracting template around event')\n        plt.savefig(eventname+\"_\"+det+\"_matchtime.\"+plottype)\n                 \n        # -- Display PSD and template\n        # must multiply by sqrt(f) to plot template fft on top of ASD:\n        plt.figure(figsize=(10,6))\n        template_f = np.absolute(template_fft)*np.sqrt(np.abs(datafreq)) / d_eff\n        plt.loglog(datafreq, template_f, 'k', label='template(f)*sqrt(f)')\n        plt.loglog(freqs, np.sqrt(data_psd),pcolor, label=det+' ASD')\n        plt.xlim(20, fs/2)\n        plt.ylim(1e-24, 1e-20)\n        plt.grid()\n        plt.xlabel('frequency (Hz)')\n        plt.ylabel('strain noise ASD (strain/rtHz), template h(f)*rt(f)')\n        plt.legend(loc='upper left')\n        plt.title(det+' ASD and template around event')\n        plt.savefig(eventname+\"_\"+det+\"_matchfreq.\"+plottype)","key":"zwNdmH5vOt"},{"type":"output","id":"JApVzR4zOF2x9g8oMuhmo","data":[{"name":"stdout","output_type":"stream","text":"For detector H1, maximum at 1126259462.4395 with SNR = 18.6, D_eff = 814.44, horizon = 1889.6 Mpc\nFor detector L1, maximum at 1126259462.4324 with SNR = 13.2, D_eff = 999.74, horizon = 1650.6 Mpc\n"},{"output_type":"display_data","metadata":{"image/png":{"height":700,"width":874}},"data":{"image/png":{"content_type":"image/png","hash":"72ea2651abbbea06a21f9ec30941dbd5","path":"/build/72ea2651abbbea06a21f9ec30941dbd5.png"},"text/plain":{"content":"\u003cFigure size 1000x800 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{"image/png":{"height":700,"width":886}},"data":{"image/png":{"content_type":"image/png","hash":"d9beb334985c50b8430e5db3d4d0bae0","path":"/build/d9beb334985c50b8430e5db3d4d0bae0.png"},"text/plain":{"content":"\u003cFigure size 1000x800 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{"image/png":{"height":547,"width":863}},"data":{"image/png":{"content_type":"image/png","hash":"317d8aae836c29f4be0cf909d9370068","path":"/build/317d8aae836c29f4be0cf909d9370068.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{"image/png":{"height":700,"width":861}},"data":{"image/png":{"content_type":"image/png","hash":"9330fdcb86d493c7b1b97f5d7cbd6342","path":"/build/9330fdcb86d493c7b1b97f5d7cbd6342.png"},"text/plain":{"content":"\u003cFigure size 1000x800 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{"image/png":{"height":700,"width":886}},"data":{"image/png":{"content_type":"image/png","hash":"f2e6095da263ab4a959a0aab3bc5073f","path":"/build/f2e6095da263ab4a959a0aab3bc5073f.png"},"text/plain":{"content":"\u003cFigure size 1000x800 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{"image/png":{"height":547,"width":863}},"data":{"image/png":{"content_type":"image/png","hash":"28e0be896a36ed5784cdf2fc45f2e420","path":"/build/28e0be896a36ed5784cdf2fc45f2e420.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"UIuknqpSLy"}],"key":"VTsZLtTDw4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notes on these results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ww8AZKSpUo"}],"identifier":"notes-on-these-results","label":"Notes on these results","html_id":"notes-on-these-results","implicit":true,"key":"wBK2ndbr3D"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We make use of only one template, with a simple ASD estimate. The full analysis produces a Bayesian posterior result using many nearby templates. It does a more careful job estimating the ASD, and includes effects of uncertain calibration.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ThyFjScLmI"}],"key":"K7KuRBNYZx"}],"key":"wMsSc8fZgM"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"As a result, our parameters (SNR, masses, spins, D_eff) are somewhat different from what you will see in our papers.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jDTNCKrSlq"}],"key":"UwMxYVc2s7"}],"key":"of9JFKUbbs"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We compute an “effective distance” D_eff. Is is NOT an estimate of the actual (luminosity) distance, which depends also on the source location and orbit orientation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZjQyLMUYSR"}],"key":"EwlkPftPoj"}],"key":"wDyveSNIr4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"These distances are at non-zero redshift, so cosmological effects must be taken into account (neglected here). Since we estimate the BH masses using the phase evolution of the waveform, which has been redshifted, our masses are themselves “redshifted”. The true source masses must be corrected for this effect; they are smaller by a factor (1+z).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dj33ItGPLl"}],"key":"hir7lalxqo"}],"key":"BIj0AcxZKf"}],"key":"zsfpEEdIRl"}],"key":"MWw32KugQS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Make sound files","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h06zTYhh7K"}],"identifier":"make-sound-files","label":"Make sound files","html_id":"make-sound-files","implicit":true,"key":"ofH7mFpb1O"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Make wav (sound) files from the filtered, downsampled data, +-2s around the event.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LfqjdMaxNf"}],"key":"qnCfp15zDD"}],"key":"onAxw93jAp"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false},"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"# make wav (sound) files from the whitened data, +-2s around the event.\n\nfrom scipy.io import wavfile\n\n# function to keep the data within integer limits, and write to wavfile:\ndef write_wavfile(filename,fs,data):\n    d = np.int16(data/np.max(np.abs(data)) * 32767 * 0.9)\n    wavfile.write(filename,int(fs), d)\n\ndeltat_sound = 2.                     # seconds around the event\n\n# index into the strain time series for this time interval:\nindxd = np.where((time \u003e= tevent-deltat_sound) \u0026 (time \u003c tevent+deltat_sound))\n\n# write the files:\nwrite_wavfile(eventname+\"_H1_whitenbp.wav\",int(fs), strain_H1_whitenbp[indxd])\nwrite_wavfile(eventname+\"_L1_whitenbp.wav\",int(fs), strain_L1_whitenbp[indxd])\n\n# re-whiten the template using the smoothed PSD; it sounds better!\ntemplate_p_smooth = whiten(template_p,psd_smooth,dt)\n\n# and the template, sooming in on [-3,+1] seconds around the merger:\nindxt = np.where((time \u003e= (time[0]+template_offset-deltat_sound)) \u0026 (time \u003c (time[0]+template_offset+deltat_sound)))\nwrite_wavfile(eventname+\"_template_whiten.wav\",int(fs), template_p_smooth[indxt])\n","key":"Wpns9UCfII"},{"type":"output","id":"T4Y8pD-cVwhVR13FFWIeO","data":[],"key":"aOtFzRLDA1"}],"key":"pTHrtaJoPx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Listen to the whitened template and data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CKVsUO01dr"}],"identifier":"listen-to-the-whitened-template-and-data","label":"Listen to the whitened template and data","html_id":"listen-to-the-whitened-template-and-data","implicit":true,"key":"STyDH4kEvz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"With good headphones, you may be able to hear a faint thump in the middle; that’s our signal!","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UDxzjUXogR"}],"key":"WuHLtPZWDe"}],"key":"pgi5vJO6OQ"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Audio\n\nfna = eventname+\"_template_whiten.wav\"\nprint(fna)\nAudio(fna)","key":"ckYoL2kd9T"},{"type":"output","id":"S3CsFcW9UBKnzJCm28EzA","data":[{"name":"stdout","output_type":"stream","text":"GW150914_template_whiten.wav\n"},{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"7cfaee44fd77b501c47d410640764933","path":"/build/7cfaee44fd77b501c47d410640764933.html"},"text/plain":{"content":"\u003cIPython.lib.display.Audio object\u003e","content_type":"text/plain"}}}],"key":"RXxQZL9kDp"}],"key":"N3oDkdjgei"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"fna = eventname+\"_H1_whitenbp.wav\"\nprint(fna)\nAudio(fna)","key":"x1ecvlNcCW"},{"type":"output","id":"PwIkPVtbnxPlYbl62BboL","data":[{"name":"stdout","output_type":"stream","text":"GW150914_H1_whitenbp.wav\n"},{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"14e0991a05c1e19dc0b94dd1b0c823a1","path":"/build/14e0991a05c1e19dc0b94dd1b0c823a1.html"},"text/plain":{"content":"\u003cIPython.lib.display.Audio object\u003e","content_type":"text/plain"}}}],"key":"obq0lgKgQY"}],"key":"XJx458rW9N"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Frequency shift the audio files","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UdR9L2i6LY"}],"identifier":"frequency-shift-the-audio-files","label":"Frequency shift the audio files","html_id":"frequency-shift-the-audio-files","implicit":true,"key":"GxZfAvETQa"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can enhance this by increasing the frequency;\nthis is the “audio” equivalent of the enhanced visuals that NASA employs on telescope images with “false color”.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hYoaHtlT12"}],"key":"hCOAq3qBJc"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The code below will shift the data up by 400 Hz (by taking an FFT, shifting/rolling the frequency series, then inverse fft-ing). The resulting sound file will be noticibly more high-pitched, and the signal will be easier to hear.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xKa7C5ZHwt"}],"key":"oSSXrvWn26"}],"key":"Iyo2YgEEkr"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# function that shifts frequency of a band-passed signal\ndef reqshift(data,fshift=100,sample_rate=4096):\n    \"\"\"Frequency shift the signal by constant\n    \"\"\"\n    x = np.fft.rfft(data)\n    T = len(data)/float(sample_rate)\n    df = 1.0/T\n    nbins = int(fshift/df)\n    # print T,df,nbins,x.real.shape\n    y = np.roll(x.real,nbins) + 1j*np.roll(x.imag,nbins)\n    y[0:nbins]=0.\n    z = np.fft.irfft(y)\n    return z\n\n# parameters for frequency shift\nfs = 4096\nfshift = 400.\nspeedup = 1.\nfss = int(float(fs)*float(speedup))\n\n# shift frequency of the data\nstrain_H1_shifted = reqshift(strain_H1_whitenbp,fshift=fshift,sample_rate=fs)\nstrain_L1_shifted = reqshift(strain_L1_whitenbp,fshift=fshift,sample_rate=fs)\n\n# write the files:\nwrite_wavfile(eventname+\"_H1_shifted.wav\",int(fs), strain_H1_shifted[indxd])\nwrite_wavfile(eventname+\"_L1_shifted.wav\",int(fs), strain_L1_shifted[indxd])\n\n# and the template:\ntemplate_p_shifted = reqshift(template_p_smooth,fshift=fshift,sample_rate=fs)\nwrite_wavfile(eventname+\"_template_shifted.wav\",int(fs), template_p_shifted[indxt])","key":"wFchM6WF5H"},{"type":"output","id":"bOyaO7t7kBzVOqSi4H8yH","data":[],"key":"LlHixsVyyZ"}],"key":"blFs0kzWjd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Listen to the frequency-shifted template and data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qD2D3rRk49"}],"identifier":"listen-to-the-frequency-shifted-template-and-data","label":"Listen to the frequency-shifted template and data","html_id":"listen-to-the-frequency-shifted-template-and-data","implicit":true,"key":"Oz5NeVmf0v"}],"key":"t1OPCQaSAk"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"fna = eventname+\"_template_shifted.wav\"\nprint(fna)\nAudio(fna)","key":"XA7Ilh65h7"},{"type":"output","id":"iv1vkvf2GrHACunkWatTw","data":[{"name":"stdout","output_type":"stream","text":"GW150914_template_shifted.wav\n"},{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"711dc2ae6c42b2f2b14fb54fa9477614","path":"/build/711dc2ae6c42b2f2b14fb54fa9477614.html"},"text/plain":{"content":"\u003cIPython.lib.display.Audio object\u003e","content_type":"text/plain"}}}],"key":"EsVAeQaZCZ"}],"key":"W9vFSEyVDG"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"fna = eventname+\"_H1_shifted.wav\"\nprint(fna)\nAudio(fna)","key":"iCmavj9ax3"},{"type":"output","id":"MdmnjjChOWzGaKBKEtN0A","data":[{"name":"stdout","output_type":"stream","text":"GW150914_H1_shifted.wav\n"},{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"ca349ce4ac118633ff0be5f96d185169","path":"/build/ca349ce4ac118633ff0be5f96d185169.html"},"text/plain":{"content":"\u003cIPython.lib.display.Audio object\u003e","content_type":"text/plain"}}}],"key":"wHTbmIoWMH"}],"key":"KMmjTRHyrf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data segments","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zx5UWp5EX5"}],"identifier":"data-segments","label":"Data segments","html_id":"data-segments","implicit":true,"key":"qNDJPzIagJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As mentioned above, LIGO strain time series data has gaps (filled with NaNs) when the detectors are not taking valid (“science quality”) data. Analyzing these data requires the user to loop over “segments” of valid data stretches.  For details, see the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NebLIRtTu3"},{"type":"link","url":"https://www.gwosc.org/timeline/","children":[{"type":"text","value":"notes on segments","key":"ztPRktTYir"}],"urlSource":"https://www.gwosc.org/timeline/","key":"Ebz8P5WWWb"},{"type":"text","value":" or ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"z1qblsVMQe"},{"type":"link","url":"https://www.gwosc.org/tutorials/","children":[{"type":"text","value":"introduction to LIGO data files","key":"FXBpXank4i"}],"urlSource":"https://www.gwosc.org/tutorials/","key":"HwVQNF0zjb"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s2edtSbYkW"}],"key":"VqxBNVisqI"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the code below, we can check times around this event for gaps in the L1 data.  You are welcome to repeat this with H1 data, with files containing 4096 seconds of data, and with data sampled at 16384 Hz. All of the relevant files can be downloaded from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DbApeC7L4b"},{"type":"link","url":"https://www.gwosc.org/events","children":[{"type":"text","value":"LOSC event pages.","key":"GMCuG3Pgrt"}],"urlSource":"https://www.gwosc.org/events","key":"GLssMd6awv"}],"key":"SRTHeZIgvV"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We also unpack the DQ and HW injection bits to check what their values are.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rcCwhNAP1V"}],"key":"dcCslM5wyr"}],"key":"PPo4yqC2ac"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"data_segments = 1\nif data_segments:\n    # read in the data at 4096 Hz:\n    # fn = 'L-L1_LOSC_4_V1-1126259446-32.hdf5'\n    strain, time, chan_dict = rl.loaddata(fn_L1, 'H1')\n\n    print(\"Contents of all the key, value pairs in chan_dict\")\n    for keys,values in chan_dict.items():\n        print(keys)\n        print(values)\n\n    print('Total number of non-NaNs in these data = ',np.sum(~np.isnan(strain)))\n    print('GPS start, GPS stop and length of  all data in this file = ',time[0], time[-1],len(strain))\n\n    # select the level of data quality; default is \"DATA\" but \"CBC_CAT3\" is a conservative choice:\n    DQflag = 'CBC_CAT3'\n    # readligo.py method for computing segments (start and stop times with continuous valid data):\n    segment_list = rl.dq_channel_to_seglist(chan_dict[DQflag])\n    print('Number of segments with DQflag',DQflag,' = ',len(segment_list))\n\n    # loop over seconds and print out start, stop and length:\n    iseg = 0\n    for segment in segment_list:\n        time_seg = time[segment]\n        seg_strain = strain[segment]\n        print('GPS start, GPS stop and length of segment',iseg, \\\n            'in this file = ',time_seg[0], time_seg[-1], len(seg_strain))\n        iseg = iseg+1\n        # here is where you would insert code to analyze the data in this segment.\n\n    # now look at segments with no CBC hardware injections:\n    DQflag = 'NO_CBC_HW_INJ'\n    segment_list = rl.dq_channel_to_seglist(chan_dict['NO_CBC_HW_INJ'])\n    print('Number of segments with DQflag',DQflag,' = ',len(segment_list))\n    iseg = 0\n    for segment in segment_list:\n        time_seg = time[segment]\n        seg_strain = strain[segment]\n        print('GPS start, GPS stop and length of segment',iseg, \\\n            'in this file = ',time_seg[0], time_seg[-1], len(seg_strain))\n        iseg = iseg+1\n","key":"z0U9O1bTYs"},{"type":"output","id":"HPQ_4QQsAg4vTep4Cjzur","data":[{"name":"stdout","output_type":"stream","text":"Contents of all the key, value pairs in chan_dict\nDATA\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nCBC_CAT1\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nCBC_CAT2\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nCBC_CAT3\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nBURST_CAT1\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nBURST_CAT2\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nBURST_CAT3\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nNO_CBC_HW_INJ\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nNO_BURST_HW_INJ\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nNO_DETCHAR_HW_INJ\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nNO_CW_HW_INJ\n[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]\nNO_STOCH_HW_INJ\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nDEFAULT\n[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]\nTotal number of non-NaNs in these data =  131072\nGPS start, GPS stop and length of  all data in this file =  1126259446.0 1126259477.9997559 131072\nNumber of segments with DQflag CBC_CAT3  =  1\nGPS start, GPS stop and length of segment 0 in this file =  1126259446.0 1126259477.9997559 131072\nNumber of segments with DQflag NO_CBC_HW_INJ  =  1\nGPS start, GPS stop and length of segment 0 in this file =  1126259446.0 1126259477.9997559 131072\n"}],"key":"BzwutDzevl"}],"key":"fv9PpR3ABZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Comments on sampling rate","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d6d8AaA9Mj"}],"identifier":"comments-on-sampling-rate","label":"Comments on sampling rate","html_id":"comments-on-sampling-rate","implicit":true,"key":"e7oxivsdTw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"LIGO data are acquired at 16384 Hz (2^14 Hz). Here, we have been working with data downsampled to 4096 Hz, to save on download time, disk space, and memory requirements.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"py4dQKSz9b"}],"key":"i8InMIunRY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This is entirely sufficient for signals with no frequency content above f_Nyquist = fs/2 = 2048 Hz, such as signals from higher-mass binary black hole systems; the frequency at which the merger begins (at the innermost stable circular orbit) for equal-mass, spinless black holes is roughly 1557 Hz * (2.8/M_tot), where 2.8 solar masses is the total mass of a canonical binary neutron star system.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nV1blYVI5V"}],"key":"tpXIfJh7RH"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"If, however, you are interested in signals with frequency content above 2048 Hz, you need the data sampled at the full rate of 16384 Hz.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YRp1INzbDs"}],"key":"oAXYWT0j5e"}],"key":"sdsl9cMoH8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Construct a csv file containing the whitened data and template","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qT1LVvStv4"}],"identifier":"construct-a-csv-file-containing-the-whitened-data-and-template","label":"Construct a csv file containing the whitened data and template","html_id":"construct-a-csv-file-containing-the-whitened-data-and-template","implicit":true,"key":"sQfdaa2ycW"}],"key":"fotc8ByL1j"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# time vector around event\ntimes = time-tevent\n# zoom in on [-0.2,0.05] seconds around event\nirange = np.nonzero((times \u003e= -0.2) \u0026 (times \u003c 0.05))\n# construct a data structure for a csv file:\ndat = [times[irange], strain_H1_whitenbp[irange],strain_L1_whitenbp[irange],\n      template_H1[irange],template_L1[irange] ]\ndatcsv = np.array(dat).transpose()\n# make a csv filename, header, and format\nfncsv = eventname+'_data.csv'\nheadcsv = eventname+' time-'+str(tevent)+ \\\n    ' (s),H1_data_whitened,L1_data_whitened,H1_template_whitened,L1_template_whitened'\nfmtcsv = \",\".join([\"%10.6f\"] * 5)\nnp.savetxt(fncsv, datcsv, fmt=fmtcsv, header=headcsv)\n\nprint(\"Wrote whitened data to file {0}\".format(fncsv))\nprint(\"You can download this file by clicking 'jupyter' in the top left corner, or using the 'data' menu in Azure.\")","key":"K1PSZ5jfCF"},{"type":"output","id":"WKNGwc_kyxJYeJivVFO8y","data":[{"name":"stdout","output_type":"stream","text":"Wrote whitened data to file GW150914_data.csv\nYou can download this file by clicking 'jupyter' in the top left corner, or using the 'data' menu in Azure.\n"}],"key":"CfLbteulXj"}],"key":"O0wAN68Ll8"}],"key":"zKusMK5bMl"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"HW3 – LIGO","url":"/","group":"HW3 – LIGO"}}},"domain":"http://localhost:3001"},"project":{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"HW3 – LIGO","authors":[{"nameParsed":{"literal":"Ligo Scientific Collaboration (LSC) and Ji Su Youn","given":"Ligo Scientific Collaboration (LSC)","non_dropping_particle":"and","family":"Ji Su Youn"},"name":"Ligo Scientific Collaboration (LSC) and Ji Su Youn","id":"contributors-myst-generated-uid-0"}],"toc":[{"file":"README.md"},{"file":"notebooks/LOSC_Event_tutorial.ipynb","title":"LOSC Event Tutorial"}],"thumbnail":"/build/4ca599c12ad03712a9fa6f4c109e48cc.svg","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"losc-event-tutorial","title":"BINARY BLACK HOLE SIGNALS IN LIGO OPEN DATA","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-06410F0D.js";
import * as route0 from "/build/root-ZJZ4LRPY.js";
import * as route1 from "/build/routes/$-23AHH5XS.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-UNPC4GT3.js");</script></body></html>